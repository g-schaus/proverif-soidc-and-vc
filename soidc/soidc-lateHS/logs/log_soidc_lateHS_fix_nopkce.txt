File "soidc_lateHS_fix_nopkce.pv", line 216, characters 9-12:
Warning: identifier sskI rebound.
Process 0 (that is, the initial process):
{1}new a: bitstring;
{2}new u: bitstring;
{3}new i: bitstring;
{4}out(c, a);
{5}out(c, u);
{6}out(c, i);
{7}new ska: SecretKey;
{8}new sku: SecretKey;
{9}new ski: SecretKey;
{10}out(c, pk(ska));
{11}out(c, pk(sku));
{12}out(c, pk(ski));
{13}new password: bitstring;
(
    {14}!
    {15}let c_1: channel = c in
    {16}let a_1: bitstring = a in
    {17}let ska_1: SecretKey = ska in
    {18}let u_1: bitstring = u in
    {19}let pku: PublicKey = pk(sku) in
    {20}let i_1: bitstring = i in
    {21}let pki: PublicKey = pk(ski) in
    {22}in(c_1, e1: bitstring);
    {23}in(c_1, e2: bitstring);
    {24}if ((e1 = u_1) && (e2 = i_1)) then
    (
        {25}let talksOnlyToHonest: bool = true in
        {26}new scope: bitstring;
        {27}let m_1: bitstring = (tag1,a_1,scope) in
        {28}out(c_1, m_1);
        {29}in(c_1, m_6: bitstring);
        {30}let (tag6': bitstring,n: bitstring,spkI: PublicKey) = adec(m_6,ska_1) in
        {31}if (tag6 = tag6') then
        {32}new k1: SymmetricKey;
        {33}let m_7: bitstring = aenc((tag7,n,k1),spkI) in
        {34}event appSendsLastMessageToBrowser(m_6,m_7);
        {35}out(c_1, m_7);
        {36}in(c_1, m_8: bitstring);
        {37}let (tag8': bitstring,code: bitstring,i': bitstring) = dec(m_8,k1) in
        {38}if (tag8 = tag8') then
        {39}if (i_1 = i') then
        {40}new n2: bitstring;
        {41}new sskI2: SecretKey;
        {42}let m_9: bitstring = aenc((tag9,n2,pk(sskI2)),pki) in
        {43}out(c_1, m_9);
        {44}in(c_1, m_10: bitstring);
        {45}let (tag10': bitstring,n2': bitstring,k3: SymmetricKey) = adec(m_10,sskI2) in
        {46}if (tag10 = tag10') then
        {47}if (n2 = n2') then
        {48}new sks: SecretKey;
        {49}new jti: bitstring;
        {50}let T2: bitstring = (a_1,jti,code) in
        {51}let m_11: bitstring = enc((tag11,pk(sks),sign(T2,sks)),k3) in
        {52}event appSendsLastMessageToIssuer(m_9,m_10,m_11);
        {53}out(c_1, m_11);
        {54}in(c_1, m_12: bitstring);
        {55}let (tag12': bitstring,signed_M: bitstring) = dec(m_12,k3) in
        {56}if (tag12 = tag12') then
        {57}let M: bitstring = check(signed_M,pki) in
        {58}let (jtk: bitstring,jti': bitstring,scope': bitstring,a': bitstring,i'': bitstring,u': bitstring) = M in
        {59}if (jtk = hash_pk(pk(sks))) then
        {60}if (jti = jti') then
        {61}if (scope = scope') then
        {62}if (a_1 = a') then
        {63}if (i_1 = i'') then
        {64}if (u_1 = u') then
        {65}if talksOnlyToHonest then
        {66}out(c_1, check_reach_app);
        {67}event appCompletesProtocol(m_6,m_7,m_8,m_9,m_10,m_11,m_12);
        {68}out(ch(code), free_code)
    )
    else
        {69}if ((e1 Ôëá u_1) && (e2 = i_1)) then
        (
            {70}in(c_1, pke1: PublicKey);
            {71}let talksOnlyToHonest_1: bool = false in
            {72}new scope_1: bitstring;
            {73}let m: bitstring = (tag1,a_1,scope_1) in
            {74}out(c_1, m);
            {75}in(c_1, m_2: bitstring);
            {76}let (tag6'_1: bitstring,n_1: bitstring,spkI_1: PublicKey) = adec(m_2,ska_1) in
            {77}if (tag6 = tag6'_1) then
            {78}new k1_1: SymmetricKey;
            {79}let m_3: bitstring = aenc((tag7,n_1,k1_1),spkI_1) in
            {80}event appSendsLastMessageToBrowser(m_2,m_3);
            {81}out(c_1, m_3);
            {82}in(c_1, m_4: bitstring);
            {83}let (tag8'_1: bitstring,code_1: bitstring,i'_1: bitstring) = dec(m_4,k1_1) in
            {84}if (tag8 = tag8'_1) then
            {85}if (i_1 = i'_1) then
            {86}new n2_1: bitstring;
            {87}new sskI2_1: SecretKey;
            {88}let m_5: bitstring = aenc((tag9,n2_1,pk(sskI2_1)),pki) in
            {89}out(c_1, m_5);
            {90}in(c_1, m_13: bitstring);
            {91}let (tag10'_1: bitstring,n2'_1: bitstring,k3_1: SymmetricKey) = adec(m_13,sskI2_1) in
            {92}if (tag10 = tag10'_1) then
            {93}if (n2_1 = n2'_1) then
            {94}new sks_1: SecretKey;
            {95}new jti_1: bitstring;
            {96}let T2_1: bitstring = (a_1,jti_1,code_1) in
            {97}let m_14: bitstring = enc((tag11,pk(sks_1),sign(T2_1,sks_1)),k3_1) in
            {98}event appSendsLastMessageToIssuer(m_5,m_13,m_14);
            {99}out(c_1, m_14);
            {100}in(c_1, m_15: bitstring);
            {101}let (tag12'_1: bitstring,signed_M_1: bitstring) = dec(m_15,k3_1) in
            {102}if (tag12 = tag12'_1) then
            {103}let M_1: bitstring = check(signed_M_1,pki) in
            {104}let (jtk_1: bitstring,jti'_1: bitstring,scope'_1: bitstring,a'_1: bitstring,i''_1: bitstring,u'_1: bitstring) = M_1 in
            {105}if (jtk_1 = hash_pk(pk(sks_1))) then
            {106}if (jti_1 = jti'_1) then
            {107}if (scope_1 = scope'_1) then
            {108}if (a_1 = a'_1) then
            {109}if (i_1 = i''_1) then
            {110}if (e1 = u'_1) then
            {111}if talksOnlyToHonest_1 then
            {112}out(c_1, check_reach_app);
            {113}event appCompletesProtocol(m_2,m_3,m_4,m_5,m_13,m_14,m_15);
            {114}out(ch(code_1), free_code)
        )
        else
            {115}if ((e1 = u_1) && (e2 Ôëá i_1)) then
            (
                {116}in(c_1, pke2: PublicKey);
                {117}let talksOnlyToHonest_2: bool = false in
                {118}new scope_2: bitstring;
                {119}let m_16: bitstring = (tag1,a_1,scope_2) in
                {120}out(c_1, m_16);
                {121}in(c_1, m_17: bitstring);
                {122}let (tag6'_2: bitstring,n_2: bitstring,spkI_2: PublicKey) = adec(m_17,ska_1) in
                {123}if (tag6 = tag6'_2) then
                {124}new k1_2: SymmetricKey;
                {125}let m_18: bitstring = aenc((tag7,n_2,k1_2),spkI_2) in
                {126}event appSendsLastMessageToBrowser(m_17,m_18);
                {127}out(c_1, m_18);
                {128}in(c_1, m_19: bitstring);
                {129}let (tag8'_2: bitstring,code_2: bitstring,i'_2: bitstring) = dec(m_19,k1_2) in
                {130}if (tag8 = tag8'_2) then
                {131}if (e2 = i'_2) then
                {132}new n2_2: bitstring;
                {133}new sskI2_2: SecretKey;
                {134}let m_20: bitstring = aenc((tag9,n2_2,pk(sskI2_2)),pke2) in
                {135}out(c_1, m_20);
                {136}in(c_1, m_21: bitstring);
                {137}let (tag10'_2: bitstring,n2'_2: bitstring,k3_2: SymmetricKey) = adec(m_21,sskI2_2) in
                {138}if (tag10 = tag10'_2) then
                {139}if (n2_2 = n2'_2) then
                {140}new sks_2: SecretKey;
                {141}new jti_2: bitstring;
                {142}let T2_2: bitstring = (a_1,jti_2,code_2) in
                {143}let m_22: bitstring = enc((tag11,pk(sks_2),sign(T2_2,sks_2)),k3_2) in
                {144}event appSendsLastMessageToIssuer(m_20,m_21,m_22);
                {145}out(c_1, m_22);
                {146}in(c_1, m_23: bitstring);
                {147}let (tag12'_2: bitstring,signed_M_2: bitstring) = dec(m_23,k3_2) in
                {148}if (tag12 = tag12'_2) then
                {149}let M_2: bitstring = check(signed_M_2,pke2) in
                {150}let (jtk_2: bitstring,jti'_2: bitstring,scope'_2: bitstring,a'_2: bitstring,i''_2: bitstring,u'_2: bitstring) = M_2 in
                {151}if (jtk_2 = hash_pk(pk(sks_2))) then
                {152}if (jti_2 = jti'_2) then
                {153}if (scope_2 = scope'_2) then
                {154}if (a_1 = a'_2) then
                {155}if (e2 = i''_2) then
                {156}if (u_1 = u'_2) then
                {157}if talksOnlyToHonest_2 then
                {158}out(c_1, check_reach_app);
                {159}event appCompletesProtocol(m_17,m_18,m_19,m_20,m_21,m_22,m_23);
                {160}out(ch(code_2), free_code)
            )
            else
                {161}if ((e1 Ôëá u_1) && (e2 Ôëá i_1)) then
                {162}in(c_1, pke1_1: PublicKey);
                {163}in(c_1, pke2_1: PublicKey);
                {164}let talksOnlyToHonest_3: bool = false in
                {165}new scope_3: bitstring;
                {166}let m_24: bitstring = (tag1,a_1,scope_3) in
                {167}out(c_1, m_24);
                {168}in(c_1, m_25: bitstring);
                {169}let (tag6'_3: bitstring,n_3: bitstring,spkI_3: PublicKey) = adec(m_25,ska_1) in
                {170}if (tag6 = tag6'_3) then
                {171}new k1_3: SymmetricKey;
                {172}let m_26: bitstring = aenc((tag7,n_3,k1_3),spkI_3) in
                {173}event appSendsLastMessageToBrowser(m_25,m_26);
                {174}out(c_1, m_26);
                {175}in(c_1, m_27: bitstring);
                {176}let (tag8'_3: bitstring,code_3: bitstring,i'_3: bitstring) = dec(m_27,k1_3) in
                {177}if (tag8 = tag8'_3) then
                {178}if (e2 = i'_3) then
                {179}new n2_3: bitstring;
                {180}new sskI2_3: SecretKey;
                {181}let m_28: bitstring = aenc((tag9,n2_3,pk(sskI2_3)),pke2_1) in
                {182}out(c_1, m_28);
                {183}in(c_1, m_29: bitstring);
                {184}let (tag10'_3: bitstring,n2'_3: bitstring,k3_3: SymmetricKey) = adec(m_29,sskI2_3) in
                {185}if (tag10 = tag10'_3) then
                {186}if (n2_3 = n2'_3) then
                {187}new sks_3: SecretKey;
                {188}new jti_3: bitstring;
                {189}let T2_3: bitstring = (a_1,jti_3,code_3) in
                {190}let m_30: bitstring = enc((tag11,pk(sks_3),sign(T2_3,sks_3)),k3_3) in
                {191}event appSendsLastMessageToIssuer(m_28,m_29,m_30);
                {192}out(c_1, m_30);
                {193}in(c_1, m_31: bitstring);
                {194}let (tag12'_3: bitstring,signed_M_3: bitstring) = dec(m_31,k3_3) in
                {195}if (tag12 = tag12'_3) then
                {196}let M_3: bitstring = check(signed_M_3,pke2_1) in
                {197}let (jtk_3: bitstring,jti'_3: bitstring,scope'_3: bitstring,a'_3: bitstring,i''_3: bitstring,u'_3: bitstring) = M_3 in
                {198}if (jtk_3 = hash_pk(pk(sks_3))) then
                {199}if (jti_3 = jti'_3) then
                {200}if (scope_3 = scope'_3) then
                {201}if (a_1 = a'_3) then
                {202}if (e2 = i''_3) then
                {203}if (e1 = u'_3) then
                {204}if talksOnlyToHonest_3 then
                {205}out(c_1, check_reach_app);
                {206}event appCompletesProtocol(m_25,m_26,m_27,m_28,m_29,m_30,m_31);
                {207}out(ch(code_3), free_code)
) | (
    {208}!
    {209}let c_2: channel = c in
    {210}let u_2: bitstring = u in
    {211}let sku_1: SecretKey = sku in
    {212}let a_2: bitstring = a in
    {213}let pka: PublicKey = pk(ska) in
    {214}let i_2: bitstring = i in
    {215}let pki_1: PublicKey = pk(ski) in
    {216}let password_1: bitstring = password in
    {217}in(c_2, e1_1: bitstring);
    {218}in(c_2, e2_1: bitstring);
    {219}if ((e1_1 = a_2) && (e2_1 = i_2)) then
    (
        {220}let talksOnlyToHonest_4: bool = true in
        {221}in(c_2, m_32: bitstring);
        {222}let (tag1': bitstring,a'_4: bitstring,scope_4: bitstring) = m_32 in
        {223}if (tag1 = tag1') then
        {224}if (a_2 = a'_4) then
        {225}new n2_4: bitstring;
        {226}new sskI: SecretKey;
        {227}let m_33: bitstring = aenc((tag2,n2_4,pk(sskI)),pki_1) in
        {228}out(c_2, m_33);
        {229}in(c_2, m_34: bitstring);
        {230}let (tag3': bitstring,n2'_4: bitstring,k2: SymmetricKey) = adec(m_34,sskI) in
        {231}if (tag3 = tag3') then
        {232}if (n2_4 = n2'_4) then
        {233}let m_35: bitstring = enc((tag4,a_2,scope_4,u_2,password_1),k2) in
        {234}event browserSendsLastMessageToIssuer(m_33,m_34,m_35);
        {235}out(c_2, m_35);
        {236}in(c_2, m_36: bitstring);
        {237}let (tag5': bitstring,code_4: bitstring,i'_4: bitstring) = dec(m_36,k2) in
        {238}if (tag5 = tag5') then
        {239}if (i_2 = i'_4) then
        {240}new n_4: bitstring;
        {241}new sskI_1: SecretKey;
        {242}let m_37: bitstring = aenc((tag6,n_4,pk(sskI_1)),pka) in
        {243}out(c_2, m_37);
        {244}in(c_2, m_38: bitstring);
        {245}let (tag7': bitstring,n': bitstring,k1_4: SymmetricKey) = adec(m_38,sskI_1) in
        {246}if (tag7 = tag7') then
        {247}if (n_4 = n') then
        {248}let m_39: bitstring = enc((tag8,code_4,i_2),k1_4) in
        {249}event browserSendsLastMessageToApp(m_37,m_38,m_39);
        {250}out(c_2, m_39);
        {251}if talksOnlyToHonest_4 then
        {252}out(c_2, check_reach_browser);
        {253}event browserCompletesProtocol(m_33,m_34,m_35,m_36,m_37,m_38);
        {254}out(ch(code_4), free_code);
        {255}out(ch(password_1), free_password)
    )
    else
        {256}if ((e1_1 Ôëá a_2) && (e2_1 = i_2)) then
        (
            {257}in(c_2, pke1_2: PublicKey);
            {258}let talksOnlyToHonest_5: bool = false in
            {259}in(c_2, m_40: bitstring);
            {260}let (tag1'_1: bitstring,a'_5: bitstring,scope_5: bitstring) = m_40 in
            {261}if (tag1 = tag1'_1) then
            {262}if (e1_1 = a'_5) then
            {263}new n2_5: bitstring;
            {264}new sskI_2: SecretKey;
            {265}let m_41: bitstring = aenc((tag2,n2_5,pk(sskI_2)),pki_1) in
            {266}out(c_2, m_41);
            {267}in(c_2, m_42: bitstring);
            {268}let (tag3'_1: bitstring,n2'_5: bitstring,k2_1: SymmetricKey) = adec(m_42,sskI_2) in
            {269}if (tag3 = tag3'_1) then
            {270}if (n2_5 = n2'_5) then
            {271}let m_43: bitstring = enc((tag4,e1_1,scope_5,u_2,password_1),k2_1) in
            {272}event browserSendsLastMessageToIssuer(m_41,m_42,m_43);
            {273}out(c_2, m_43);
            {274}in(c_2, m_44: bitstring);
            {275}let (tag5'_1: bitstring,code_5: bitstring,i'_5: bitstring) = dec(m_44,k2_1) in
            {276}if (tag5 = tag5'_1) then
            {277}if (i_2 = i'_5) then
            {278}new n_5: bitstring;
            {279}new sskI_3: SecretKey;
            {280}let m_45: bitstring = aenc((tag6,n_5,pk(sskI_3)),pke1_2) in
            {281}out(c_2, m_45);
            {282}in(c_2, m_46: bitstring);
            {283}let (tag7'_1: bitstring,n'_1: bitstring,k1_5: SymmetricKey) = adec(m_46,sskI_3) in
            {284}if (tag7 = tag7'_1) then
            {285}if (n_5 = n'_1) then
            {286}let m_47: bitstring = enc((tag8,code_5,i_2),k1_5) in
            {287}event browserSendsLastMessageToApp(m_45,m_46,m_47);
            {288}out(c_2, m_47);
            {289}if talksOnlyToHonest_5 then
            {290}out(c_2, check_reach_browser);
            {291}event browserCompletesProtocol(m_41,m_42,m_43,m_44,m_45,m_46);
            {292}out(ch(code_5), free_code);
            {293}out(ch(password_1), free_password)
        )
        else
            {294}if ((e1_1 = a_2) && (e2_1 Ôëá i_2)) then
            (
                {295}in(c_2, pke2_2: PublicKey);
                {296}new wrong_pw: bitstring;
                {297}let talksOnlyToHonest_6: bool = false in
                {298}let password_2: bitstring = wrong_pw in
                {299}in(c_2, m_48: bitstring);
                {300}let (tag1'_2: bitstring,a'_6: bitstring,scope_6: bitstring) = m_48 in
                {301}if (tag1 = tag1'_2) then
                {302}if (a_2 = a'_6) then
                {303}new n2_6: bitstring;
                {304}new sskI_4: SecretKey;
                {305}let m_49: bitstring = aenc((tag2,n2_6,pk(sskI_4)),pke2_2) in
                {306}out(c_2, m_49);
                {307}in(c_2, m_50: bitstring);
                {308}let (tag3'_2: bitstring,n2'_6: bitstring,k2_2: SymmetricKey) = adec(m_50,sskI_4) in
                {309}if (tag3 = tag3'_2) then
                {310}if (n2_6 = n2'_6) then
                {311}let m_51: bitstring = enc((tag4,a_2,scope_6,u_2,password_2),k2_2) in
                {312}event browserSendsLastMessageToIssuer(m_49,m_50,m_51);
                {313}out(c_2, m_51);
                {314}in(c_2, m_52: bitstring);
                {315}let (tag5'_2: bitstring,code_6: bitstring,i'_6: bitstring) = dec(m_52,k2_2) in
                {316}if (tag5 = tag5'_2) then
                {317}if (e2_1 = i'_6) then
                {318}new n_6: bitstring;
                {319}new sskI_5: SecretKey;
                {320}let m_53: bitstring = aenc((tag6,n_6,pk(sskI_5)),pka) in
                {321}out(c_2, m_53);
                {322}in(c_2, m_54: bitstring);
                {323}let (tag7'_2: bitstring,n'_2: bitstring,k1_6: SymmetricKey) = adec(m_54,sskI_5) in
                {324}if (tag7 = tag7'_2) then
                {325}if (n_6 = n'_2) then
                {326}let m_55: bitstring = enc((tag8,code_6,e2_1),k1_6) in
                {327}event browserSendsLastMessageToApp(m_53,m_54,m_55);
                {328}out(c_2, m_55);
                {329}if talksOnlyToHonest_6 then
                {330}out(c_2, check_reach_browser);
                {331}event browserCompletesProtocol(m_49,m_50,m_51,m_52,m_53,m_54);
                {332}out(ch(code_6), free_code);
                {333}out(ch(password_2), free_password)
            )
            else
                {334}if ((e1_1 Ôëá a_2) && (e2_1 Ôëá i_2)) then
                {335}in(c_2, pke1_3: PublicKey);
                {336}in(c_2, pke2_3: PublicKey);
                {337}new wrong_pw_1: bitstring;
                {338}let talksOnlyToHonest_7: bool = false in
                {339}let password_3: bitstring = wrong_pw_1 in
                {340}in(c_2, m_56: bitstring);
                {341}let (tag1'_3: bitstring,a'_7: bitstring,scope_7: bitstring) = m_56 in
                {342}if (tag1 = tag1'_3) then
                {343}if (e1_1 = a'_7) then
                {344}new n2_7: bitstring;
                {345}new sskI_6: SecretKey;
                {346}let m_57: bitstring = aenc((tag2,n2_7,pk(sskI_6)),pke2_3) in
                {347}out(c_2, m_57);
                {348}in(c_2, m_58: bitstring);
                {349}let (tag3'_3: bitstring,n2'_7: bitstring,k2_3: SymmetricKey) = adec(m_58,sskI_6) in
                {350}if (tag3 = tag3'_3) then
                {351}if (n2_7 = n2'_7) then
                {352}let m_59: bitstring = enc((tag4,e1_1,scope_7,u_2,password_3),k2_3) in
                {353}event browserSendsLastMessageToIssuer(m_57,m_58,m_59);
                {354}out(c_2, m_59);
                {355}in(c_2, m_60: bitstring);
                {356}let (tag5'_3: bitstring,code_7: bitstring,i'_7: bitstring) = dec(m_60,k2_3) in
                {357}if (tag5 = tag5'_3) then
                {358}if (e2_1 = i'_7) then
                {359}new n_7: bitstring;
                {360}new sskI_7: SecretKey;
                {361}let m_61: bitstring = aenc((tag6,n_7,pk(sskI_7)),pke1_3) in
                {362}out(c_2, m_61);
                {363}in(c_2, m_62: bitstring);
                {364}let (tag7'_3: bitstring,n'_3: bitstring,k1_7: SymmetricKey) = adec(m_62,sskI_7) in
                {365}if (tag7 = tag7'_3) then
                {366}if (n_7 = n'_3) then
                {367}let m_63: bitstring = enc((tag8,code_7,e2_1),k1_7) in
                {368}event browserSendsLastMessageToApp(m_61,m_62,m_63);
                {369}out(c_2, m_63);
                {370}if talksOnlyToHonest_7 then
                {371}out(c_2, check_reach_browser);
                {372}event browserCompletesProtocol(m_57,m_58,m_59,m_60,m_61,m_62);
                {373}out(ch(code_7), free_code);
                {374}out(ch(password_3), free_password)
) | (
    {375}!
    {376}let c_3: channel = c in
    {377}let i_3: bitstring = i in
    {378}let ski_1: SecretKey = ski in
    {379}let a_3: bitstring = a in
    {380}let pka_1: PublicKey = pk(ska) in
    {381}let u_3: bitstring = u in
    {382}let pku_1: PublicKey = pk(sku) in
    {383}let password_4: bitstring = password in
    {384}in(c_3, e1_2: bitstring);
    {385}in(c_3, e2_2: bitstring);
    {386}if ((e1_2 = a_3) && (e2_2 = u_3)) then
    (
        {387}let talksOnlyToHonest_8: bool = true in
        {388}in(c_3, m_64: bitstring);
        {389}let (tag2': bitstring,n_8: bitstring,spkI_4: PublicKey) = adec(m_64,ski_1) in
        {390}if (tag2 = tag2') then
        {391}new k2_4: SymmetricKey;
        {392}let m_65: bitstring = aenc((tag3,n_8,k2_4),spkI_4) in
        {393}out(c_3, m_65);
        {394}in(c_3, m_66: bitstring);
        {395}let (tag4': bitstring,a'_8: bitstring,scope_8: bitstring,u'_4: bitstring,password': bitstring) = dec(m_66,k2_4) in
        {396}if (tag4 = tag4') then
        {397}if (a_3 = a'_8) then
        {398}if (u_3 = u'_4) then
        {399}if (password_4 = password') then
        {400}new code_8: bitstring;
        {401}let m_67: bitstring = enc((tag5,code_8,i_3),k2_4) in
        {402}event issuerSendsLastMessageToBrowser(m_64,m_65,m_66,m_67);
        {403}out(c_3, m_67);
        {404}in(c_3, m_68: bitstring);
        {405}let (tag9': bitstring,n2_8: bitstring,spkI2: PublicKey) = adec(m_68,ski_1) in
        {406}if (tag9 = tag9') then
        {407}new k3_4: SymmetricKey;
        {408}let m_69: bitstring = aenc((tag10,n2_8,k3_4),spkI2) in
        {409}out(c_3, m_69);
        {410}in(c_3, m_70: bitstring);
        {411}let (tag11': bitstring,pksks: PublicKey,signature: bitstring) = dec(m_70,k3_4) in
        {412}if (tag11 = tag11') then
        {413}let (a'': bitstring,jti_4: bitstring,code': bitstring) = check(signature,pksks) in
        {414}if (a'_8 = a'') then
        {415}if (code_8 = code') then
        {416}let jtk_4: bitstring = hash_pk(pksks) in
        {417}let M_4: bitstring = (jtk_4,jti_4,scope_8,a_3,i_3,u_3) in
        {418}let m_71: bitstring = enc((tag12,sign(M_4,ski_1)),k3_4) in
        {419}event issuerSendsLastMessageToApp(m_68,m_69,m_70,m_71);
        {420}out(c_3, m_71);
        {421}if talksOnlyToHonest_8 then
        {422}out(c_3, check_reach_issuer);
        {423}event issuerCompletesProtocol(m_64,m_65,m_66,m_68,m_69,m_70);
        {424}out(ch(code_8), free_code);
        {425}out(ch(password_4), free_password)
    )
    else
        {426}if ((e1_2 Ôëá a_3) && (e2_2 = u_3)) then
        (
            {427}in(c_3, pke1_4: PublicKey);
            {428}let talksOnlyToHonest_9: bool = false in
            {429}in(c_3, m_72: bitstring);
            {430}let (tag2'_1: bitstring,n_9: bitstring,spkI_5: PublicKey) = adec(m_72,ski_1) in
            {431}if (tag2 = tag2'_1) then
            {432}new k2_5: SymmetricKey;
            {433}let m_73: bitstring = aenc((tag3,n_9,k2_5),spkI_5) in
            {434}out(c_3, m_73);
            {435}in(c_3, m_74: bitstring);
            {436}let (tag4'_1: bitstring,a'_9: bitstring,scope_9: bitstring,u'_5: bitstring,password'_1: bitstring) = dec(m_74,k2_5) in
            {437}if (tag4 = tag4'_1) then
            {438}if (e1_2 = a'_9) then
            {439}if (u_3 = u'_5) then
            {440}if (password_4 = password'_1) then
            {441}new code_9: bitstring;
            {442}let m_75: bitstring = enc((tag5,code_9,i_3),k2_5) in
            {443}event issuerSendsLastMessageToBrowser(m_72,m_73,m_74,m_75);
            {444}out(c_3, m_75);
            {445}in(c_3, m_76: bitstring);
            {446}let (tag9'_1: bitstring,n2_9: bitstring,spkI2_1: PublicKey) = adec(m_76,ski_1) in
            {447}if (tag9 = tag9'_1) then
            {448}new k3_5: SymmetricKey;
            {449}let m_77: bitstring = aenc((tag10,n2_9,k3_5),spkI2_1) in
            {450}out(c_3, m_77);
            {451}in(c_3, m_78: bitstring);
            {452}let (tag11'_1: bitstring,pksks_1: PublicKey,signature_1: bitstring) = dec(m_78,k3_5) in
            {453}if (tag11 = tag11'_1) then
            {454}let (a''_1: bitstring,jti_5: bitstring,code'_1: bitstring) = check(signature_1,pksks_1) in
            {455}if (a'_9 = a''_1) then
            {456}if (code_9 = code'_1) then
            {457}let jtk_5: bitstring = hash_pk(pksks_1) in
            {458}let M_5: bitstring = (jtk_5,jti_5,scope_9,e1_2,i_3,u_3) in
            {459}let m_79: bitstring = enc((tag12,sign(M_5,ski_1)),k3_5) in
            {460}event issuerSendsLastMessageToApp(m_76,m_77,m_78,m_79);
            {461}out(c_3, m_79);
            {462}if talksOnlyToHonest_9 then
            {463}out(c_3, check_reach_issuer);
            {464}event issuerCompletesProtocol(m_72,m_73,m_74,m_76,m_77,m_78);
            {465}out(ch(code_9), free_code);
            {466}out(ch(password_4), free_password)
        )
        else
            {467}if ((e1_2 = a_3) && (e2_2 Ôëá u_3)) then
            (
                {468}new wrong_pw_2: bitstring;
                {469}in(c_3, pke2_4: PublicKey);
                {470}let talksOnlyToHonest_10: bool = false in
                {471}let password_5: bitstring = wrong_pw_2 in
                {472}in(c_3, m_80: bitstring);
                {473}let (tag2'_2: bitstring,n_10: bitstring,spkI_6: PublicKey) = adec(m_80,ski_1) in
                {474}if (tag2 = tag2'_2) then
                {475}new k2_6: SymmetricKey;
                {476}let m_81: bitstring = aenc((tag3,n_10,k2_6),spkI_6) in
                {477}out(c_3, m_81);
                {478}in(c_3, m_82: bitstring);
                {479}let (tag4'_2: bitstring,a'_10: bitstring,scope_10: bitstring,u'_6: bitstring,password'_2: bitstring) = dec(m_82,k2_6) in
                {480}if (tag4 = tag4'_2) then
                {481}if (a_3 = a'_10) then
                {482}if (e2_2 = u'_6) then
                {483}if (password_5 = password'_2) then
                {484}new code_10: bitstring;
                {485}let m_83: bitstring = enc((tag5,code_10,i_3),k2_6) in
                {486}event issuerSendsLastMessageToBrowser(m_80,m_81,m_82,m_83);
                {487}out(c_3, m_83);
                {488}in(c_3, m_84: bitstring);
                {489}let (tag9'_2: bitstring,n2_10: bitstring,spkI2_2: PublicKey) = adec(m_84,ski_1) in
                {490}if (tag9 = tag9'_2) then
                {491}new k3_6: SymmetricKey;
                {492}let m_85: bitstring = aenc((tag10,n2_10,k3_6),spkI2_2) in
                {493}out(c_3, m_85);
                {494}in(c_3, m_86: bitstring);
                {495}let (tag11'_2: bitstring,pksks_2: PublicKey,signature_2: bitstring) = dec(m_86,k3_6) in
                {496}if (tag11 = tag11'_2) then
                {497}let (a''_2: bitstring,jti_6: bitstring,code'_2: bitstring) = check(signature_2,pksks_2) in
                {498}if (a'_10 = a''_2) then
                {499}if (code_10 = code'_2) then
                {500}let jtk_6: bitstring = hash_pk(pksks_2) in
                {501}let M_6: bitstring = (jtk_6,jti_6,scope_10,a_3,i_3,e2_2) in
                {502}let m_87: bitstring = enc((tag12,sign(M_6,ski_1)),k3_6) in
                {503}event issuerSendsLastMessageToApp(m_84,m_85,m_86,m_87);
                {504}out(c_3, m_87);
                {505}if talksOnlyToHonest_10 then
                {506}out(c_3, check_reach_issuer);
                {507}event issuerCompletesProtocol(m_80,m_81,m_82,m_84,m_85,m_86);
                {508}out(ch(code_10), free_code);
                {509}out(ch(password_5), free_password)
            )
            else
                {510}if ((e1_2 Ôëá a_3) && (e2_2 Ôëá u_3)) then
                {511}new wrong_pw_3: bitstring;
                {512}in(c_3, pke1_5: PublicKey);
                {513}in(c_3, pke2_5: PublicKey);
                {514}let talksOnlyToHonest_11: bool = false in
                {515}let password_6: bitstring = wrong_pw_3 in
                {516}in(c_3, m_88: bitstring);
                {517}let (tag2'_3: bitstring,n_11: bitstring,spkI_7: PublicKey) = adec(m_88,ski_1) in
                {518}if (tag2 = tag2'_3) then
                {519}new k2_7: SymmetricKey;
                {520}let m_89: bitstring = aenc((tag3,n_11,k2_7),spkI_7) in
                {521}out(c_3, m_89);
                {522}in(c_3, m_90: bitstring);
                {523}let (tag4'_3: bitstring,a'_11: bitstring,scope_11: bitstring,u'_7: bitstring,password'_3: bitstring) = dec(m_90,k2_7) in
                {524}if (tag4 = tag4'_3) then
                {525}if (e1_2 = a'_11) then
                {526}if (e2_2 = u'_7) then
                {527}if (password_6 = password'_3) then
                {528}new code_11: bitstring;
                {529}let m_91: bitstring = enc((tag5,code_11,i_3),k2_7) in
                {530}event issuerSendsLastMessageToBrowser(m_88,m_89,m_90,m_91);
                {531}out(c_3, m_91);
                {532}in(c_3, m_92: bitstring);
                {533}let (tag9'_3: bitstring,n2_11: bitstring,spkI2_3: PublicKey) = adec(m_92,ski_1) in
                {534}if (tag9 = tag9'_3) then
                {535}new k3_7: SymmetricKey;
                {536}let m_93: bitstring = aenc((tag10,n2_11,k3_7),spkI2_3) in
                {537}out(c_3, m_93);
                {538}in(c_3, m_94: bitstring);
                {539}let (tag11'_3: bitstring,pksks_3: PublicKey,signature_3: bitstring) = dec(m_94,k3_7) in
                {540}if (tag11 = tag11'_3) then
                {541}let (a''_3: bitstring,jti_7: bitstring,code'_3: bitstring) = check(signature_3,pksks_3) in
                {542}if (a'_11 = a''_3) then
                {543}if (code_11 = code'_3) then
                {544}let jtk_7: bitstring = hash_pk(pksks_3) in
                {545}let M_7: bitstring = (jtk_7,jti_7,scope_11,e1_2,i_3,e2_2) in
                {546}let m_95: bitstring = enc((tag12,sign(M_7,ski_1)),k3_7) in
                {547}event issuerSendsLastMessageToApp(m_92,m_93,m_94,m_95);
                {548}out(c_3, m_95);
                {549}if talksOnlyToHonest_11 then
                {550}out(c_3, check_reach_issuer);
                {551}event issuerCompletesProtocol(m_88,m_89,m_90,m_92,m_93,m_94);
                {552}out(ch(code_11), free_code);
                {553}out(ch(password_6), free_password)
)

--  Process 1 (that is, process 0, with let moved downwards):
{1}new a: bitstring;
{2}new u: bitstring;
{3}new i: bitstring;
{4}out(c, a);
{5}out(c, u);
{6}out(c, i);
{7}new ska: SecretKey;
{8}new sku: SecretKey;
{9}new ski: SecretKey;
{10}out(c, pk(ska));
{11}out(c, pk(sku));
{12}out(c, pk(ski));
{13}new password: bitstring;
(
    {14}!
    {15}let c_1: channel = c in
    {22}in(c_1, e1: bitstring);
    {23}in(c_1, e2: bitstring);
    {21}let pki: PublicKey = pk(ski) in
    {20}let i_1: bitstring = i in
    {18}let u_1: bitstring = u in
    {17}let ska_1: SecretKey = ska in
    {16}let a_1: bitstring = a in
    {24}if ((e1 = u_1) && (e2 = i_1)) then
    (
        {26}new scope: bitstring;
        {27}let m_1: bitstring = (tag1,a_1,scope) in
        {28}out(c_1, m_1);
        {29}in(c_1, m_6: bitstring);
        {30}let (tag6': bitstring,n: bitstring,spkI: PublicKey) = adec(m_6,ska_1) in
        {31}if (tag6 = tag6') then
        {32}new k1: SymmetricKey;
        {33}let m_7: bitstring = aenc((tag7,n,k1),spkI) in
        {34}event appSendsLastMessageToBrowser(m_6,m_7);
        {35}out(c_1, m_7);
        {36}in(c_1, m_8: bitstring);
        {37}let (tag8': bitstring,code: bitstring,i': bitstring) = dec(m_8,k1) in
        {38}if (tag8 = tag8') then
        {39}if (i_1 = i') then
        {40}new n2: bitstring;
        {41}new sskI2: SecretKey;
        {42}let m_9: bitstring = aenc((tag9,n2,pk(sskI2)),pki) in
        {43}out(c_1, m_9);
        {44}in(c_1, m_10: bitstring);
        {45}let (tag10': bitstring,n2': bitstring,k3: SymmetricKey) = adec(m_10,sskI2) in
        {46}if (tag10 = tag10') then
        {47}if (n2 = n2') then
        {48}new sks: SecretKey;
        {49}new jti: bitstring;
        {50}let T2: bitstring = (a_1,jti,code) in
        {51}let m_11: bitstring = enc((tag11,pk(sks),sign(T2,sks)),k3) in
        {52}event appSendsLastMessageToIssuer(m_9,m_10,m_11);
        {53}out(c_1, m_11);
        {54}in(c_1, m_12: bitstring);
        {55}let (tag12': bitstring,signed_M: bitstring) = dec(m_12,k3) in
        {56}if (tag12 = tag12') then
        {57}let M: bitstring = check(signed_M,pki) in
        {58}let (jtk: bitstring,jti': bitstring,scope': bitstring,a': bitstring,i'': bitstring,u': bitstring) = M in
        {59}if (jtk = hash_pk(pk(sks))) then
        {60}if (jti = jti') then
        {61}if (scope = scope') then
        {62}if (a_1 = a') then
        {63}if (i_1 = i'') then
        {64}if (u_1 = u') then
        {25}let talksOnlyToHonest: bool = true in
        {65}if talksOnlyToHonest then
        {66}out(c_1, check_reach_app);
        {67}event appCompletesProtocol(m_6,m_7,m_8,m_9,m_10,m_11,m_12);
        {68}out(ch(code), free_code)
    )
    else
        {69}if ((e1 Ôëá u_1) && (e2 = i_1)) then
        (
            {70}in(c_1, pke1: PublicKey);
            {72}new scope_1: bitstring;
            {73}let m: bitstring = (tag1,a_1,scope_1) in
            {74}out(c_1, m);
            {75}in(c_1, m_2: bitstring);
            {76}let (tag6'_1: bitstring,n_1: bitstring,spkI_1: PublicKey) = adec(m_2,ska_1) in
            {77}if (tag6 = tag6'_1) then
            {78}new k1_1: SymmetricKey;
            {79}let m_3: bitstring = aenc((tag7,n_1,k1_1),spkI_1) in
            {80}event appSendsLastMessageToBrowser(m_2,m_3);
            {81}out(c_1, m_3);
            {82}in(c_1, m_4: bitstring);
            {83}let (tag8'_1: bitstring,code_1: bitstring,i'_1: bitstring) = dec(m_4,k1_1) in
            {84}if (tag8 = tag8'_1) then
            {85}if (i_1 = i'_1) then
            {86}new n2_1: bitstring;
            {87}new sskI2_1: SecretKey;
            {88}let m_5: bitstring = aenc((tag9,n2_1,pk(sskI2_1)),pki) in
            {89}out(c_1, m_5);
            {90}in(c_1, m_13: bitstring);
            {91}let (tag10'_1: bitstring,n2'_1: bitstring,k3_1: SymmetricKey) = adec(m_13,sskI2_1) in
            {92}if (tag10 = tag10'_1) then
            {93}if (n2_1 = n2'_1) then
            {94}new sks_1: SecretKey;
            {95}new jti_1: bitstring;
            {96}let T2_1: bitstring = (a_1,jti_1,code_1) in
            {97}let m_14: bitstring = enc((tag11,pk(sks_1),sign(T2_1,sks_1)),k3_1) in
            {98}event appSendsLastMessageToIssuer(m_5,m_13,m_14);
            {99}out(c_1, m_14);
            {100}in(c_1, m_15: bitstring);
            {101}let (tag12'_1: bitstring,signed_M_1: bitstring) = dec(m_15,k3_1) in
            {102}if (tag12 = tag12'_1) then
            {103}let M_1: bitstring = check(signed_M_1,pki) in
            {104}let (jtk_1: bitstring,jti'_1: bitstring,scope'_1: bitstring,a'_1: bitstring,i''_1: bitstring,u'_1: bitstring) = M_1 in
            {105}if (jtk_1 = hash_pk(pk(sks_1))) then
            {106}if (jti_1 = jti'_1) then
            {107}if (scope_1 = scope'_1) then
            {108}if (a_1 = a'_1) then
            {109}if (i_1 = i''_1) then
            {110}if (e1 = u'_1) then
            {71}let talksOnlyToHonest_1: bool = false in
            {111}if talksOnlyToHonest_1 then
            {112}out(c_1, check_reach_app);
            {113}event appCompletesProtocol(m_2,m_3,m_4,m_5,m_13,m_14,m_15);
            {114}out(ch(code_1), free_code)
        )
        else
            {115}if ((e1 = u_1) && (e2 Ôëá i_1)) then
            (
                {116}in(c_1, pke2: PublicKey);
                {118}new scope_2: bitstring;
                {119}let m_16: bitstring = (tag1,a_1,scope_2) in
                {120}out(c_1, m_16);
                {121}in(c_1, m_17: bitstring);
                {122}let (tag6'_2: bitstring,n_2: bitstring,spkI_2: PublicKey) = adec(m_17,ska_1) in
                {123}if (tag6 = tag6'_2) then
                {124}new k1_2: SymmetricKey;
                {125}let m_18: bitstring = aenc((tag7,n_2,k1_2),spkI_2) in
                {126}event appSendsLastMessageToBrowser(m_17,m_18);
                {127}out(c_1, m_18);
                {128}in(c_1, m_19: bitstring);
                {129}let (tag8'_2: bitstring,code_2: bitstring,i'_2: bitstring) = dec(m_19,k1_2) in
                {130}if (tag8 = tag8'_2) then
                {131}if (e2 = i'_2) then
                {132}new n2_2: bitstring;
                {133}new sskI2_2: SecretKey;
                {134}let m_20: bitstring = aenc((tag9,n2_2,pk(sskI2_2)),pke2) in
                {135}out(c_1, m_20);
                {136}in(c_1, m_21: bitstring);
                {137}let (tag10'_2: bitstring,n2'_2: bitstring,k3_2: SymmetricKey) = adec(m_21,sskI2_2) in
                {138}if (tag10 = tag10'_2) then
                {139}if (n2_2 = n2'_2) then
                {140}new sks_2: SecretKey;
                {141}new jti_2: bitstring;
                {142}let T2_2: bitstring = (a_1,jti_2,code_2) in
                {143}let m_22: bitstring = enc((tag11,pk(sks_2),sign(T2_2,sks_2)),k3_2) in
                {144}event appSendsLastMessageToIssuer(m_20,m_21,m_22);
                {145}out(c_1, m_22);
                {146}in(c_1, m_23: bitstring);
                {147}let (tag12'_2: bitstring,signed_M_2: bitstring) = dec(m_23,k3_2) in
                {148}if (tag12 = tag12'_2) then
                {149}let M_2: bitstring = check(signed_M_2,pke2) in
                {150}let (jtk_2: bitstring,jti'_2: bitstring,scope'_2: bitstring,a'_2: bitstring,i''_2: bitstring,u'_2: bitstring) = M_2 in
                {151}if (jtk_2 = hash_pk(pk(sks_2))) then
                {152}if (jti_2 = jti'_2) then
                {153}if (scope_2 = scope'_2) then
                {154}if (a_1 = a'_2) then
                {155}if (e2 = i''_2) then
                {156}if (u_1 = u'_2) then
                {117}let talksOnlyToHonest_2: bool = false in
                {157}if talksOnlyToHonest_2 then
                {158}out(c_1, check_reach_app);
                {159}event appCompletesProtocol(m_17,m_18,m_19,m_20,m_21,m_22,m_23);
                {160}out(ch(code_2), free_code)
            )
            else
                {161}if ((e1 Ôëá u_1) && (e2 Ôëá i_1)) then
                {162}in(c_1, pke1_1: PublicKey);
                {163}in(c_1, pke2_1: PublicKey);
                {165}new scope_3: bitstring;
                {166}let m_24: bitstring = (tag1,a_1,scope_3) in
                {167}out(c_1, m_24);
                {168}in(c_1, m_25: bitstring);
                {169}let (tag6'_3: bitstring,n_3: bitstring,spkI_3: PublicKey) = adec(m_25,ska_1) in
                {170}if (tag6 = tag6'_3) then
                {171}new k1_3: SymmetricKey;
                {172}let m_26: bitstring = aenc((tag7,n_3,k1_3),spkI_3) in
                {173}event appSendsLastMessageToBrowser(m_25,m_26);
                {174}out(c_1, m_26);
                {175}in(c_1, m_27: bitstring);
                {176}let (tag8'_3: bitstring,code_3: bitstring,i'_3: bitstring) = dec(m_27,k1_3) in
                {177}if (tag8 = tag8'_3) then
                {178}if (e2 = i'_3) then
                {179}new n2_3: bitstring;
                {180}new sskI2_3: SecretKey;
                {181}let m_28: bitstring = aenc((tag9,n2_3,pk(sskI2_3)),pke2_1) in
                {182}out(c_1, m_28);
                {183}in(c_1, m_29: bitstring);
                {184}let (tag10'_3: bitstring,n2'_3: bitstring,k3_3: SymmetricKey) = adec(m_29,sskI2_3) in
                {185}if (tag10 = tag10'_3) then
                {186}if (n2_3 = n2'_3) then
                {187}new sks_3: SecretKey;
                {188}new jti_3: bitstring;
                {189}let T2_3: bitstring = (a_1,jti_3,code_3) in
                {190}let m_30: bitstring = enc((tag11,pk(sks_3),sign(T2_3,sks_3)),k3_3) in
                {191}event appSendsLastMessageToIssuer(m_28,m_29,m_30);
                {192}out(c_1, m_30);
                {193}in(c_1, m_31: bitstring);
                {194}let (tag12'_3: bitstring,signed_M_3: bitstring) = dec(m_31,k3_3) in
                {195}if (tag12 = tag12'_3) then
                {196}let M_3: bitstring = check(signed_M_3,pke2_1) in
                {197}let (jtk_3: bitstring,jti'_3: bitstring,scope'_3: bitstring,a'_3: bitstring,i''_3: bitstring,u'_3: bitstring) = M_3 in
                {198}if (jtk_3 = hash_pk(pk(sks_3))) then
                {199}if (jti_3 = jti'_3) then
                {200}if (scope_3 = scope'_3) then
                {201}if (a_1 = a'_3) then
                {202}if (e2 = i''_3) then
                {203}if (e1 = u'_3) then
                {164}let talksOnlyToHonest_3: bool = false in
                {204}if talksOnlyToHonest_3 then
                {205}out(c_1, check_reach_app);
                {206}event appCompletesProtocol(m_25,m_26,m_27,m_28,m_29,m_30,m_31);
                {207}out(ch(code_3), free_code)
) | (
    {208}!
    {209}let c_2: channel = c in
    {217}in(c_2, e1_1: bitstring);
    {218}in(c_2, e2_1: bitstring);
    {216}let password_1: bitstring = password in
    {215}let pki_1: PublicKey = pk(ski) in
    {214}let i_2: bitstring = i in
    {213}let pka: PublicKey = pk(ska) in
    {212}let a_2: bitstring = a in
    {210}let u_2: bitstring = u in
    {219}if ((e1_1 = a_2) && (e2_1 = i_2)) then
    (
        {221}in(c_2, m_32: bitstring);
        {222}let (tag1': bitstring,a'_4: bitstring,scope_4: bitstring) = m_32 in
        {223}if (tag1 = tag1') then
        {224}if (a_2 = a'_4) then
        {225}new n2_4: bitstring;
        {226}new sskI: SecretKey;
        {227}let m_33: bitstring = aenc((tag2,n2_4,pk(sskI)),pki_1) in
        {228}out(c_2, m_33);
        {229}in(c_2, m_34: bitstring);
        {230}let (tag3': bitstring,n2'_4: bitstring,k2: SymmetricKey) = adec(m_34,sskI) in
        {231}if (tag3 = tag3') then
        {232}if (n2_4 = n2'_4) then
        {233}let m_35: bitstring = enc((tag4,a_2,scope_4,u_2,password_1),k2) in
        {234}event browserSendsLastMessageToIssuer(m_33,m_34,m_35);
        {235}out(c_2, m_35);
        {236}in(c_2, m_36: bitstring);
        {237}let (tag5': bitstring,code_4: bitstring,i'_4: bitstring) = dec(m_36,k2) in
        {238}if (tag5 = tag5') then
        {239}if (i_2 = i'_4) then
        {240}new n_4: bitstring;
        {241}new sskI_1: SecretKey;
        {242}let m_37: bitstring = aenc((tag6,n_4,pk(sskI_1)),pka) in
        {243}out(c_2, m_37);
        {244}in(c_2, m_38: bitstring);
        {245}let (tag7': bitstring,n': bitstring,k1_4: SymmetricKey) = adec(m_38,sskI_1) in
        {246}if (tag7 = tag7') then
        {247}if (n_4 = n') then
        {248}let m_39: bitstring = enc((tag8,code_4,i_2),k1_4) in
        {249}event browserSendsLastMessageToApp(m_37,m_38,m_39);
        {250}out(c_2, m_39);
        {220}let talksOnlyToHonest_4: bool = true in
        {251}if talksOnlyToHonest_4 then
        {252}out(c_2, check_reach_browser);
        {253}event browserCompletesProtocol(m_33,m_34,m_35,m_36,m_37,m_38);
        {254}out(ch(code_4), free_code);
        {255}out(ch(password_1), free_password)
    )
    else
        {256}if ((e1_1 Ôëá a_2) && (e2_1 = i_2)) then
        (
            {257}in(c_2, pke1_2: PublicKey);
            {259}in(c_2, m_40: bitstring);
            {260}let (tag1'_1: bitstring,a'_5: bitstring,scope_5: bitstring) = m_40 in
            {261}if (tag1 = tag1'_1) then
            {262}if (e1_1 = a'_5) then
            {263}new n2_5: bitstring;
            {264}new sskI_2: SecretKey;
            {265}let m_41: bitstring = aenc((tag2,n2_5,pk(sskI_2)),pki_1) in
            {266}out(c_2, m_41);
            {267}in(c_2, m_42: bitstring);
            {268}let (tag3'_1: bitstring,n2'_5: bitstring,k2_1: SymmetricKey) = adec(m_42,sskI_2) in
            {269}if (tag3 = tag3'_1) then
            {270}if (n2_5 = n2'_5) then
            {271}let m_43: bitstring = enc((tag4,e1_1,scope_5,u_2,password_1),k2_1) in
            {272}event browserSendsLastMessageToIssuer(m_41,m_42,m_43);
            {273}out(c_2, m_43);
            {274}in(c_2, m_44: bitstring);
            {275}let (tag5'_1: bitstring,code_5: bitstring,i'_5: bitstring) = dec(m_44,k2_1) in
            {276}if (tag5 = tag5'_1) then
            {277}if (i_2 = i'_5) then
            {278}new n_5: bitstring;
            {279}new sskI_3: SecretKey;
            {280}let m_45: bitstring = aenc((tag6,n_5,pk(sskI_3)),pke1_2) in
            {281}out(c_2, m_45);
            {282}in(c_2, m_46: bitstring);
            {283}let (tag7'_1: bitstring,n'_1: bitstring,k1_5: SymmetricKey) = adec(m_46,sskI_3) in
            {284}if (tag7 = tag7'_1) then
            {285}if (n_5 = n'_1) then
            {286}let m_47: bitstring = enc((tag8,code_5,i_2),k1_5) in
            {287}event browserSendsLastMessageToApp(m_45,m_46,m_47);
            {288}out(c_2, m_47);
            {258}let talksOnlyToHonest_5: bool = false in
            {289}if talksOnlyToHonest_5 then
            {290}out(c_2, check_reach_browser);
            {291}event browserCompletesProtocol(m_41,m_42,m_43,m_44,m_45,m_46);
            {292}out(ch(code_5), free_code);
            {293}out(ch(password_1), free_password)
        )
        else
            {294}if ((e1_1 = a_2) && (e2_1 Ôëá i_2)) then
            (
                {295}in(c_2, pke2_2: PublicKey);
                {296}new wrong_pw: bitstring;
                {299}in(c_2, m_48: bitstring);
                {300}let (tag1'_2: bitstring,a'_6: bitstring,scope_6: bitstring) = m_48 in
                {301}if (tag1 = tag1'_2) then
                {302}if (a_2 = a'_6) then
                {303}new n2_6: bitstring;
                {304}new sskI_4: SecretKey;
                {305}let m_49: bitstring = aenc((tag2,n2_6,pk(sskI_4)),pke2_2) in
                {306}out(c_2, m_49);
                {307}in(c_2, m_50: bitstring);
                {308}let (tag3'_2: bitstring,n2'_6: bitstring,k2_2: SymmetricKey) = adec(m_50,sskI_4) in
                {309}if (tag3 = tag3'_2) then
                {310}if (n2_6 = n2'_6) then
                {298}let password_2: bitstring = wrong_pw in
                {311}let m_51: bitstring = enc((tag4,a_2,scope_6,u_2,password_2),k2_2) in
                {312}event browserSendsLastMessageToIssuer(m_49,m_50,m_51);
                {313}out(c_2, m_51);
                {314}in(c_2, m_52: bitstring);
                {315}let (tag5'_2: bitstring,code_6: bitstring,i'_6: bitstring) = dec(m_52,k2_2) in
                {316}if (tag5 = tag5'_2) then
                {317}if (e2_1 = i'_6) then
                {318}new n_6: bitstring;
                {319}new sskI_5: SecretKey;
                {320}let m_53: bitstring = aenc((tag6,n_6,pk(sskI_5)),pka) in
                {321}out(c_2, m_53);
                {322}in(c_2, m_54: bitstring);
                {323}let (tag7'_2: bitstring,n'_2: bitstring,k1_6: SymmetricKey) = adec(m_54,sskI_5) in
                {324}if (tag7 = tag7'_2) then
                {325}if (n_6 = n'_2) then
                {326}let m_55: bitstring = enc((tag8,code_6,e2_1),k1_6) in
                {327}event browserSendsLastMessageToApp(m_53,m_54,m_55);
                {328}out(c_2, m_55);
                {297}let talksOnlyToHonest_6: bool = false in
                {329}if talksOnlyToHonest_6 then
                {330}out(c_2, check_reach_browser);
                {331}event browserCompletesProtocol(m_49,m_50,m_51,m_52,m_53,m_54);
                {332}out(ch(code_6), free_code);
                {333}out(ch(password_2), free_password)
            )
            else
                {334}if ((e1_1 Ôëá a_2) && (e2_1 Ôëá i_2)) then
                {335}in(c_2, pke1_3: PublicKey);
                {336}in(c_2, pke2_3: PublicKey);
                {337}new wrong_pw_1: bitstring;
                {340}in(c_2, m_56: bitstring);
                {341}let (tag1'_3: bitstring,a'_7: bitstring,scope_7: bitstring) = m_56 in
                {342}if (tag1 = tag1'_3) then
                {343}if (e1_1 = a'_7) then
                {344}new n2_7: bitstring;
                {345}new sskI_6: SecretKey;
                {346}let m_57: bitstring = aenc((tag2,n2_7,pk(sskI_6)),pke2_3) in
                {347}out(c_2, m_57);
                {348}in(c_2, m_58: bitstring);
                {349}let (tag3'_3: bitstring,n2'_7: bitstring,k2_3: SymmetricKey) = adec(m_58,sskI_6) in
                {350}if (tag3 = tag3'_3) then
                {351}if (n2_7 = n2'_7) then
                {339}let password_3: bitstring = wrong_pw_1 in
                {352}let m_59: bitstring = enc((tag4,e1_1,scope_7,u_2,password_3),k2_3) in
                {353}event browserSendsLastMessageToIssuer(m_57,m_58,m_59);
                {354}out(c_2, m_59);
                {355}in(c_2, m_60: bitstring);
                {356}let (tag5'_3: bitstring,code_7: bitstring,i'_7: bitstring) = dec(m_60,k2_3) in
                {357}if (tag5 = tag5'_3) then
                {358}if (e2_1 = i'_7) then
                {359}new n_7: bitstring;
                {360}new sskI_7: SecretKey;
                {361}let m_61: bitstring = aenc((tag6,n_7,pk(sskI_7)),pke1_3) in
                {362}out(c_2, m_61);
                {363}in(c_2, m_62: bitstring);
                {364}let (tag7'_3: bitstring,n'_3: bitstring,k1_7: SymmetricKey) = adec(m_62,sskI_7) in
                {365}if (tag7 = tag7'_3) then
                {366}if (n_7 = n'_3) then
                {367}let m_63: bitstring = enc((tag8,code_7,e2_1),k1_7) in
                {368}event browserSendsLastMessageToApp(m_61,m_62,m_63);
                {369}out(c_2, m_63);
                {338}let talksOnlyToHonest_7: bool = false in
                {370}if talksOnlyToHonest_7 then
                {371}out(c_2, check_reach_browser);
                {372}event browserCompletesProtocol(m_57,m_58,m_59,m_60,m_61,m_62);
                {373}out(ch(code_7), free_code);
                {374}out(ch(password_3), free_password)
) | (
    {375}!
    {376}let c_3: channel = c in
    {384}in(c_3, e1_2: bitstring);
    {385}in(c_3, e2_2: bitstring);
    {383}let password_4: bitstring = password in
    {381}let u_3: bitstring = u in
    {379}let a_3: bitstring = a in
    {378}let ski_1: SecretKey = ski in
    {377}let i_3: bitstring = i in
    {386}if ((e1_2 = a_3) && (e2_2 = u_3)) then
    (
        {388}in(c_3, m_64: bitstring);
        {389}let (tag2': bitstring,n_8: bitstring,spkI_4: PublicKey) = adec(m_64,ski_1) in
        {390}if (tag2 = tag2') then
        {391}new k2_4: SymmetricKey;
        {392}let m_65: bitstring = aenc((tag3,n_8,k2_4),spkI_4) in
        {393}out(c_3, m_65);
        {394}in(c_3, m_66: bitstring);
        {395}let (tag4': bitstring,a'_8: bitstring,scope_8: bitstring,u'_4: bitstring,password': bitstring) = dec(m_66,k2_4) in
        {396}if (tag4 = tag4') then
        {397}if (a_3 = a'_8) then
        {398}if (u_3 = u'_4) then
        {399}if (password_4 = password') then
        {400}new code_8: bitstring;
        {401}let m_67: bitstring = enc((tag5,code_8,i_3),k2_4) in
        {402}event issuerSendsLastMessageToBrowser(m_64,m_65,m_66,m_67);
        {403}out(c_3, m_67);
        {404}in(c_3, m_68: bitstring);
        {405}let (tag9': bitstring,n2_8: bitstring,spkI2: PublicKey) = adec(m_68,ski_1) in
        {406}if (tag9 = tag9') then
        {407}new k3_4: SymmetricKey;
        {408}let m_69: bitstring = aenc((tag10,n2_8,k3_4),spkI2) in
        {409}out(c_3, m_69);
        {410}in(c_3, m_70: bitstring);
        {411}let (tag11': bitstring,pksks: PublicKey,signature: bitstring) = dec(m_70,k3_4) in
        {412}if (tag11 = tag11') then
        {413}let (a'': bitstring,jti_4: bitstring,code': bitstring) = check(signature,pksks) in
        {414}if (a'_8 = a'') then
        {415}if (code_8 = code') then
        {416}let jtk_4: bitstring = hash_pk(pksks) in
        {417}let M_4: bitstring = (jtk_4,jti_4,scope_8,a_3,i_3,u_3) in
        {418}let m_71: bitstring = enc((tag12,sign(M_4,ski_1)),k3_4) in
        {419}event issuerSendsLastMessageToApp(m_68,m_69,m_70,m_71);
        {420}out(c_3, m_71);
        {387}let talksOnlyToHonest_8: bool = true in
        {421}if talksOnlyToHonest_8 then
        {422}out(c_3, check_reach_issuer);
        {423}event issuerCompletesProtocol(m_64,m_65,m_66,m_68,m_69,m_70);
        {424}out(ch(code_8), free_code);
        {425}out(ch(password_4), free_password)
    )
    else
        {426}if ((e1_2 Ôëá a_3) && (e2_2 = u_3)) then
        (
            {427}in(c_3, pke1_4: PublicKey);
            {429}in(c_3, m_72: bitstring);
            {430}let (tag2'_1: bitstring,n_9: bitstring,spkI_5: PublicKey) = adec(m_72,ski_1) in
            {431}if (tag2 = tag2'_1) then
            {432}new k2_5: SymmetricKey;
            {433}let m_73: bitstring = aenc((tag3,n_9,k2_5),spkI_5) in
            {434}out(c_3, m_73);
            {435}in(c_3, m_74: bitstring);
            {436}let (tag4'_1: bitstring,a'_9: bitstring,scope_9: bitstring,u'_5: bitstring,password'_1: bitstring) = dec(m_74,k2_5) in
            {437}if (tag4 = tag4'_1) then
            {438}if (e1_2 = a'_9) then
            {439}if (u_3 = u'_5) then
            {440}if (password_4 = password'_1) then
            {441}new code_9: bitstring;
            {442}let m_75: bitstring = enc((tag5,code_9,i_3),k2_5) in
            {443}event issuerSendsLastMessageToBrowser(m_72,m_73,m_74,m_75);
            {444}out(c_3, m_75);
            {445}in(c_3, m_76: bitstring);
            {446}let (tag9'_1: bitstring,n2_9: bitstring,spkI2_1: PublicKey) = adec(m_76,ski_1) in
            {447}if (tag9 = tag9'_1) then
            {448}new k3_5: SymmetricKey;
            {449}let m_77: bitstring = aenc((tag10,n2_9,k3_5),spkI2_1) in
            {450}out(c_3, m_77);
            {451}in(c_3, m_78: bitstring);
            {452}let (tag11'_1: bitstring,pksks_1: PublicKey,signature_1: bitstring) = dec(m_78,k3_5) in
            {453}if (tag11 = tag11'_1) then
            {454}let (a''_1: bitstring,jti_5: bitstring,code'_1: bitstring) = check(signature_1,pksks_1) in
            {455}if (a'_9 = a''_1) then
            {456}if (code_9 = code'_1) then
            {457}let jtk_5: bitstring = hash_pk(pksks_1) in
            {458}let M_5: bitstring = (jtk_5,jti_5,scope_9,e1_2,i_3,u_3) in
            {459}let m_79: bitstring = enc((tag12,sign(M_5,ski_1)),k3_5) in
            {460}event issuerSendsLastMessageToApp(m_76,m_77,m_78,m_79);
            {461}out(c_3, m_79);
            {428}let talksOnlyToHonest_9: bool = false in
            {462}if talksOnlyToHonest_9 then
            {463}out(c_3, check_reach_issuer);
            {464}event issuerCompletesProtocol(m_72,m_73,m_74,m_76,m_77,m_78);
            {465}out(ch(code_9), free_code);
            {466}out(ch(password_4), free_password)
        )
        else
            {467}if ((e1_2 = a_3) && (e2_2 Ôëá u_3)) then
            (
                {468}new wrong_pw_2: bitstring;
                {469}in(c_3, pke2_4: PublicKey);
                {472}in(c_3, m_80: bitstring);
                {473}let (tag2'_2: bitstring,n_10: bitstring,spkI_6: PublicKey) = adec(m_80,ski_1) in
                {474}if (tag2 = tag2'_2) then
                {475}new k2_6: SymmetricKey;
                {476}let m_81: bitstring = aenc((tag3,n_10,k2_6),spkI_6) in
                {477}out(c_3, m_81);
                {478}in(c_3, m_82: bitstring);
                {479}let (tag4'_2: bitstring,a'_10: bitstring,scope_10: bitstring,u'_6: bitstring,password'_2: bitstring) = dec(m_82,k2_6) in
                {480}if (tag4 = tag4'_2) then
                {481}if (a_3 = a'_10) then
                {482}if (e2_2 = u'_6) then
                {471}let password_5: bitstring = wrong_pw_2 in
                {483}if (password_5 = password'_2) then
                {484}new code_10: bitstring;
                {485}let m_83: bitstring = enc((tag5,code_10,i_3),k2_6) in
                {486}event issuerSendsLastMessageToBrowser(m_80,m_81,m_82,m_83);
                {487}out(c_3, m_83);
                {488}in(c_3, m_84: bitstring);
                {489}let (tag9'_2: bitstring,n2_10: bitstring,spkI2_2: PublicKey) = adec(m_84,ski_1) in
                {490}if (tag9 = tag9'_2) then
                {491}new k3_6: SymmetricKey;
                {492}let m_85: bitstring = aenc((tag10,n2_10,k3_6),spkI2_2) in
                {493}out(c_3, m_85);
                {494}in(c_3, m_86: bitstring);
                {495}let (tag11'_2: bitstring,pksks_2: PublicKey,signature_2: bitstring) = dec(m_86,k3_6) in
                {496}if (tag11 = tag11'_2) then
                {497}let (a''_2: bitstring,jti_6: bitstring,code'_2: bitstring) = check(signature_2,pksks_2) in
                {498}if (a'_10 = a''_2) then
                {499}if (code_10 = code'_2) then
                {500}let jtk_6: bitstring = hash_pk(pksks_2) in
                {501}let M_6: bitstring = (jtk_6,jti_6,scope_10,a_3,i_3,e2_2) in
                {502}let m_87: bitstring = enc((tag12,sign(M_6,ski_1)),k3_6) in
                {503}event issuerSendsLastMessageToApp(m_84,m_85,m_86,m_87);
                {504}out(c_3, m_87);
                {470}let talksOnlyToHonest_10: bool = false in
                {505}if talksOnlyToHonest_10 then
                {506}out(c_3, check_reach_issuer);
                {507}event issuerCompletesProtocol(m_80,m_81,m_82,m_84,m_85,m_86);
                {508}out(ch(code_10), free_code);
                {509}out(ch(password_5), free_password)
            )
            else
                {510}if ((e1_2 Ôëá a_3) && (e2_2 Ôëá u_3)) then
                {511}new wrong_pw_3: bitstring;
                {512}in(c_3, pke1_5: PublicKey);
                {513}in(c_3, pke2_5: PublicKey);
                {516}in(c_3, m_88: bitstring);
                {517}let (tag2'_3: bitstring,n_11: bitstring,spkI_7: PublicKey) = adec(m_88,ski_1) in
                {518}if (tag2 = tag2'_3) then
                {519}new k2_7: SymmetricKey;
                {520}let m_89: bitstring = aenc((tag3,n_11,k2_7),spkI_7) in
                {521}out(c_3, m_89);
                {522}in(c_3, m_90: bitstring);
                {523}let (tag4'_3: bitstring,a'_11: bitstring,scope_11: bitstring,u'_7: bitstring,password'_3: bitstring) = dec(m_90,k2_7) in
                {524}if (tag4 = tag4'_3) then
                {525}if (e1_2 = a'_11) then
                {526}if (e2_2 = u'_7) then
                {515}let password_6: bitstring = wrong_pw_3 in
                {527}if (password_6 = password'_3) then
                {528}new code_11: bitstring;
                {529}let m_91: bitstring = enc((tag5,code_11,i_3),k2_7) in
                {530}event issuerSendsLastMessageToBrowser(m_88,m_89,m_90,m_91);
                {531}out(c_3, m_91);
                {532}in(c_3, m_92: bitstring);
                {533}let (tag9'_3: bitstring,n2_11: bitstring,spkI2_3: PublicKey) = adec(m_92,ski_1) in
                {534}if (tag9 = tag9'_3) then
                {535}new k3_7: SymmetricKey;
                {536}let m_93: bitstring = aenc((tag10,n2_11,k3_7),spkI2_3) in
                {537}out(c_3, m_93);
                {538}in(c_3, m_94: bitstring);
                {539}let (tag11'_3: bitstring,pksks_3: PublicKey,signature_3: bitstring) = dec(m_94,k3_7) in
                {540}if (tag11 = tag11'_3) then
                {541}let (a''_3: bitstring,jti_7: bitstring,code'_3: bitstring) = check(signature_3,pksks_3) in
                {542}if (a'_11 = a''_3) then
                {543}if (code_11 = code'_3) then
                {544}let jtk_7: bitstring = hash_pk(pksks_3) in
                {545}let M_7: bitstring = (jtk_7,jti_7,scope_11,e1_2,i_3,e2_2) in
                {546}let m_95: bitstring = enc((tag12,sign(M_7,ski_1)),k3_7) in
                {547}event issuerSendsLastMessageToApp(m_92,m_93,m_94,m_95);
                {548}out(c_3, m_95);
                {514}let talksOnlyToHonest_11: bool = false in
                {549}if talksOnlyToHonest_11 then
                {550}out(c_3, check_reach_issuer);
                {551}event issuerCompletesProtocol(m_88,m_89,m_90,m_92,m_93,m_94);
                {552}out(ch(code_11), free_code);
                {553}out(ch(password_6), free_password)
)

-- Query not attacker(check_reach_app[]) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 46 rules.
400 rules inserted. Base: 320 rules (92 with conclusion selected). Queue: 89 rules.
600 rules inserted. Base: 441 rules (119 with conclusion selected). Queue: 78 rules.
800 rules inserted. Base: 530 rules (133 with conclusion selected). Queue: 83 rules.
1000 rules inserted. Base: 568 rules (146 with conclusion selected). Queue: 75 rules.
1200 rules inserted. Base: 628 rules (167 with conclusion selected). Queue: 56 rules.
1400 rules inserted. Base: 719 rules (197 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 778 rules (217 with conclusion selected). Queue: 77 rules.
1800 rules inserted. Base: 850 rules (246 with conclusion selected). Queue: 98 rules.
2000 rules inserted. Base: 947 rules (277 with conclusion selected). Queue: 78 rules.
2200 rules inserted. Base: 1065 rules (306 with conclusion selected). Queue: 57 rules.
2400 rules inserted. Base: 1169 rules (323 with conclusion selected). Queue: 23 rules.
Starting query not attacker(check_reach_app[])
goal reachable: attacker(check_reach_app[])

Derivation:
Abbreviations:
scope_12 = scope[e2 = i[],e1 = u[],!1 = @sid]
n2_12 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
sskI_8 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
k2_8 = k2_4[m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_2]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_2]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_8)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
sskI_9 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_8)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
k1_8 = k1[m_6 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
n2_13 = n2[m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
sskI2_4 = sskI2[m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
k3_8 = k3_4[m_68 = aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_2]
sks_4 = sks[m_10 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
jti_8 = jti[m_10 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]

1. The message u[] may be sent to the attacker at output {5}.
attacker(u[]).

2. The message i[] may be sent to the attacker at output {6}.
attacker(i[]).

3. The message a[] may be sent to the attacker at output {4}.
attacker(a[]).

4. The message u[] that the attacker may have by 1 may be received at input {22}.
The message i[] that the attacker may have by 2 may be received at input {23}.
So the message (tag1,a[],scope_12) may be sent to the attacker at output {28}.
attacker((tag1,a[],scope_12)).

5. By 4, the attacker may know (tag1,a[],scope_12).
Using the function 3-proj-3-tuple the attacker may obtain scope_12.
attacker(scope_12).

6. Using the function tag1 the attacker may obtain tag1.
attacker(tag1).

7. By 6, the attacker may know tag1.
By 3, the attacker may know a[].
By 5, the attacker may know scope_12.
Using the function 3-tuple the attacker may obtain (tag1,a[],scope_12).
attacker((tag1,a[],scope_12)).

8. The message a[] that the attacker may have by 3 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 7 may be received at input {221}.
So the message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) may be sent to the attacker at output {228}.
attacker(aenc((tag2,n2_12,pk(sskI_8)),pk(ski[]))).

9. The message a[] that the attacker may have by 3 may be received at input {384}.
The message u[] that the attacker may have by 1 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 8 may be received at input {388}.
So the message aenc((tag3,n2_12,k2_8),pk(sskI_8)) may be sent to the attacker at output {393}.
attacker(aenc((tag3,n2_12,k2_8),pk(sskI_8))).

10. The message a[] that the attacker may have by 3 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 7 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 9 may be received at input {229}.
So the message enc((tag4,a[],scope_12,u[],password[]),k2_8) may be sent to the attacker at output {235}.
attacker(enc((tag4,a[],scope_12,u[],password[]),k2_8)).

11. The message a[] that the attacker may have by 3 may be received at input {384}.
The message u[] that the attacker may have by 1 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 8 may be received at input {388}.
The message enc((tag4,a[],scope_12,u[],password[]),k2_8) that the attacker may have by 10 may be received at input {394}.
So the message enc((tag5,code_12,i[]),k2_8) may be sent to the attacker at output {403}.
attacker(enc((tag5,code_12,i[]),k2_8)).

12. The message a[] that the attacker may have by 3 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 7 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 9 may be received at input {229}.
The message enc((tag5,code_12,i[]),k2_8) that the attacker may have by 11 may be received at input {236}.
So the message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) may be sent to the attacker at output {243}.
attacker(aenc((tag6,n_12,pk(sskI_9)),pk(ska[]))).

13. The message u[] that the attacker may have by 1 may be received at input {22}.
The message i[] that the attacker may have by 2 may be received at input {23}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 12 may be received at input {29}.
So the message aenc((tag7,n_12,k1_8),pk(sskI_9)) may be sent to the attacker at output {35}.
attacker(aenc((tag7,n_12,k1_8),pk(sskI_9))).

14. The message a[] that the attacker may have by 3 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 7 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 9 may be received at input {229}.
The message enc((tag5,code_12,i[]),k2_8) that the attacker may have by 11 may be received at input {236}.
The message aenc((tag7,n_12,k1_8),pk(sskI_9)) that the attacker may have by 13 may be received at input {244}.
So the message enc((tag8,code_12,i[]),k1_8) may be sent to the attacker at output {250}.
attacker(enc((tag8,code_12,i[]),k1_8)).

15. The message u[] that the attacker may have by 1 may be received at input {22}.
The message i[] that the attacker may have by 2 may be received at input {23}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 12 may be received at input {29}.
The message enc((tag8,code_12,i[]),k1_8) that the attacker may have by 14 may be received at input {36}.
So the message aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])) may be sent to the attacker at output {43}.
attacker(aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[]))).

16. The message a[] that the attacker may have by 3 may be received at input {384}.
The message u[] that the attacker may have by 1 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 8 may be received at input {388}.
The message enc((tag4,a[],scope_12,u[],password[]),k2_8) that the attacker may have by 10 may be received at input {394}.
The message aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])) that the attacker may have by 15 may be received at input {404}.
So the message aenc((tag10,n2_13,k3_8),pk(sskI2_4)) may be sent to the attacker at output {409}.
attacker(aenc((tag10,n2_13,k3_8),pk(sskI2_4))).

17. The message u[] that the attacker may have by 1 may be received at input {22}.
The message i[] that the attacker may have by 2 may be received at input {23}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 12 may be received at input {29}.
The message enc((tag8,code_12,i[]),k1_8) that the attacker may have by 14 may be received at input {36}.
The message aenc((tag10,n2_13,k3_8),pk(sskI2_4)) that the attacker may have by 16 may be received at input {44}.
So the message enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8) may be sent to the attacker at output {53}.
attacker(enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8)).

18. The message a[] that the attacker may have by 3 may be received at input {384}.
The message u[] that the attacker may have by 1 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 8 may be received at input {388}.
The message enc((tag4,a[],scope_12,u[],password[]),k2_8) that the attacker may have by 10 may be received at input {394}.
The message aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])) that the attacker may have by 15 may be received at input {404}.
The message enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8) that the attacker may have by 17 may be received at input {410}.
So the message enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a[],i[],u[]),ski[])),k3_8) may be sent to the attacker at output {420}.
attacker(enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a[],i[],u[]),ski[])),k3_8)).

19. The message u[] that the attacker may have by 1 may be received at input {22}.
The message i[] that the attacker may have by 2 may be received at input {23}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 12 may be received at input {29}.
The message enc((tag8,code_12,i[]),k1_8) that the attacker may have by 14 may be received at input {36}.
The message aenc((tag10,n2_13,k3_8),pk(sskI2_4)) that the attacker may have by 16 may be received at input {44}.
The message enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a[],i[],u[]),ski[])),k3_8) that the attacker may have by 18 may be received at input {54}.
So the message check_reach_app[] may be sent to the attacker at output {66}.
attacker(check_reach_app[]).

20. By 19, attacker(check_reach_app[]).
The goal is reached, represented in the following fact:
attacker(check_reach_app[]).


A more detailed output of the traces is available with
  set traceDisplay = long.

new a: bitstring creating a_4 at {1}

new u: bitstring creating u_4 at {2}

new i: bitstring creating i_4 at {3}

out(c, ~M) with ~M = a_4 at {4}

out(c, ~M_1) with ~M_1 = u_4 at {5}

out(c, ~M_2) with ~M_2 = i_4 at {6}

new ska: SecretKey creating ska_2 at {7}

new sku: SecretKey creating sku_2 at {8}

new ski: SecretKey creating ski_2 at {9}

out(c, ~M_3) with ~M_3 = pk(ska_2) at {10}

out(c, ~M_4) with ~M_4 = pk(sku_2) at {11}

out(c, ~M_5) with ~M_5 = pk(ski_2) at {12}

new password: bitstring creating password_7 at {13}

in(c, ~M_1) with ~M_1 = u_4 at {22} in copy a_5

in(c, ~M_2) with ~M_2 = i_4 at {23} in copy a_5

new scope: bitstring creating scope_12 at {26} in copy a_5

out(c, (~M_6,~M_7,~M_8)) with ~M_6 = tag1, ~M_7 = a_4, ~M_8 = scope_12 at {28} in copy a_5

in(c, ~M) with ~M = a_4 at {217} in copy a_6

in(c, ~M_2) with ~M_2 = i_4 at {218} in copy a_6

in(c, (tag1,~M,~M_8)) with ~M = a_4, ~M_8 = scope_12 at {221} in copy a_6

new n2_4: bitstring creating n2_12 at {225} in copy a_6

new sskI: SecretKey creating sskI_8 at {226} in copy a_6

out(c, ~M_9) with ~M_9 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)) at {228} in copy a_6

in(c, ~M) with ~M = a_4 at {384} in copy a_7

in(c, ~M_1) with ~M_1 = u_4 at {385} in copy a_7

in(c, ~M_9) with ~M_9 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)) at {388} in copy a_7

new k2_4: SymmetricKey creating k2_8 at {391} in copy a_7

out(c, ~M_10) with ~M_10 = aenc((tag3,n2_12,k2_8),pk(sskI_8)) at {393} in copy a_7

in(c, ~M_10) with ~M_10 = aenc((tag3,n2_12,k2_8),pk(sskI_8)) at {229} in copy a_6

event browserSendsLastMessageToIssuer(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,scope_12,u_4,password_7),k2_8)) at {234} in copy a_6

out(c, ~M_11) with ~M_11 = enc((tag4,a_4,scope_12,u_4,password_7),k2_8) at {235} in copy a_6

in(c, ~M_11) with ~M_11 = enc((tag4,a_4,scope_12,u_4,password_7),k2_8) at {394} in copy a_7

new code_8: bitstring creating code_12 at {400} in copy a_7

event issuerSendsLastMessageToBrowser(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,scope_12,u_4,password_7),k2_8),enc((tag5,code_12,i_4),k2_8)) at {402} in copy a_7

out(c, ~M_12) with ~M_12 = enc((tag5,code_12,i_4),k2_8) at {403} in copy a_7

in(c, ~M_12) with ~M_12 = enc((tag5,code_12,i_4),k2_8) at {236} in copy a_6

new n_4: bitstring creating n_12 at {240} in copy a_6

new sskI_1: SecretKey creating sskI_9 at {241} in copy a_6

out(c, ~M_13) with ~M_13 = aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)) at {243} in copy a_6

in(c, ~M_13) with ~M_13 = aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)) at {29} in copy a_5

new k1: SymmetricKey creating k1_8 at {32} in copy a_5

event appSendsLastMessageToBrowser(aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9))) at {34} in copy a_5

out(c, ~M_14) with ~M_14 = aenc((tag7,n_12,k1_8),pk(sskI_9)) at {35} in copy a_5

in(c, ~M_14) with ~M_14 = aenc((tag7,n_12,k1_8),pk(sskI_9)) at {244} in copy a_6

event browserSendsLastMessageToApp(aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9)),enc((tag8,code_12,i_4),k1_8)) at {249} in copy a_6

out(c, ~M_15) with ~M_15 = enc((tag8,code_12,i_4),k1_8) at {250} in copy a_6

out(c, ~M_16) with ~M_16 = check_reach_browser at {252} in copy a_6

event browserCompletesProtocol(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,scope_12,u_4,password_7),k2_8),enc((tag5,code_12,i_4),k2_8),aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9))) at {253} in copy a_6

in(c, ~M_15) with ~M_15 = enc((tag8,code_12,i_4),k1_8) at {36} in copy a_5

new n2: bitstring creating n2_13 at {40} in copy a_5

new sskI2: SecretKey creating sskI2_4 at {41} in copy a_5

out(c, ~M_17) with ~M_17 = aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)) at {43} in copy a_5

in(c, ~M_17) with ~M_17 = aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)) at {404} in copy a_7

new k3_4: SymmetricKey creating k3_8 at {407} in copy a_7

out(c, ~M_18) with ~M_18 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)) at {409} in copy a_7

in(c, ~M_18) with ~M_18 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)) at {44} in copy a_5

new sks: SecretKey creating sks_4 at {48} in copy a_5

new jti: bitstring creating jti_8 at {49} in copy a_5

event appSendsLastMessageToIssuer(aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)),aenc((tag10,n2_13,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8)) at {52} in copy a_5

out(c, ~M_19) with ~M_19 = enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8) at {53} in copy a_5

in(c, ~M_19) with ~M_19 = enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8) at {410} in copy a_7

event issuerSendsLastMessageToApp(aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)),aenc((tag10,n2_13,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8),enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a_4,i_4,u_4),ski_2)),k3_8)) at {419} in copy a_7

out(c, ~M_20) with ~M_20 = enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a_4,i_4,u_4),ski_2)),k3_8) at {420} in copy a_7

out(c, ~M_21) with ~M_21 = check_reach_issuer at {422} in copy a_7

event issuerCompletesProtocol(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,scope_12,u_4,password_7),k2_8),aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)),aenc((tag10,n2_13,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8)) at {423} in copy a_7

in(c, ~M_20) with ~M_20 = enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a_4,i_4,u_4),ski_2)),k3_8) at {54} in copy a_5

out(c, ~M_22) with ~M_22 = check_reach_app at {66} in copy a_5

event appCompletesProtocol(aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9)),enc((tag8,code_12,i_4),k1_8),aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)),aenc((tag10,n2_13,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8),enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a_4,i_4,u_4),ski_2)),k3_8)) at {67} in copy a_5

The attacker has the message ~M_22 = check_reach_app.
A trace has been found.
RESULT not attacker(check_reach_app[]) is false.
-- Query not attacker(check_reach_browser[]) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 46 rules.
400 rules inserted. Base: 320 rules (92 with conclusion selected). Queue: 89 rules.
600 rules inserted. Base: 441 rules (119 with conclusion selected). Queue: 78 rules.
800 rules inserted. Base: 530 rules (133 with conclusion selected). Queue: 83 rules.
1000 rules inserted. Base: 568 rules (146 with conclusion selected). Queue: 75 rules.
1200 rules inserted. Base: 628 rules (167 with conclusion selected). Queue: 56 rules.
1400 rules inserted. Base: 719 rules (197 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 778 rules (217 with conclusion selected). Queue: 77 rules.
1800 rules inserted. Base: 850 rules (246 with conclusion selected). Queue: 98 rules.
2000 rules inserted. Base: 947 rules (277 with conclusion selected). Queue: 78 rules.
2200 rules inserted. Base: 1065 rules (306 with conclusion selected). Queue: 57 rules.
2400 rules inserted. Base: 1169 rules (323 with conclusion selected). Queue: 23 rules.
Starting query not attacker(check_reach_browser[])
goal reachable: attacker(check_reach_browser[])

Derivation:
Abbreviations:
n2_12 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_8)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_8)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1_3[m_25 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),pke2_1 = pke2_6,pke1_1 = pke1_6,e2 = e2_3,e1 = e1_3,!1 = @sid_2]

1. The message a[] may be sent to the attacker at output {4}.
attacker(a[]).

2. The message i[] may be sent to the attacker at output {6}.
attacker(i[]).

3. The attacker has some term scope_12.
attacker(scope_12).

4. Using the function tag1 the attacker may obtain tag1.
attacker(tag1).

5. By 4, the attacker may know tag1.
By 1, the attacker may know a[].
By 3, the attacker may know scope_12.
Using the function 3-tuple the attacker may obtain (tag1,a[],scope_12).
attacker((tag1,a[],scope_12)).

6. The message u[] may be sent to the attacker at output {5}.
attacker(u[]).

7. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 5 may be received at input {221}.
So the message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) may be sent to the attacker at output {228}.
attacker(aenc((tag2,n2_12,pk(sskI_8)),pk(ski[]))).

8. The message a[] that the attacker may have by 1 may be received at input {384}.
The message u[] that the attacker may have by 6 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 7 may be received at input {388}.
So the message aenc((tag3,n2_12,k2_8),pk(sskI_8)) may be sent to the attacker at output {393}.
attacker(aenc((tag3,n2_12,k2_8),pk(sskI_8))).

9. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 5 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 8 may be received at input {229}.
So the message enc((tag4,a[],scope_12,u[],password[]),k2_8) may be sent to the attacker at output {235}.
attacker(enc((tag4,a[],scope_12,u[],password[]),k2_8)).

10. The message a[] that the attacker may have by 1 may be received at input {384}.
The message u[] that the attacker may have by 6 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 7 may be received at input {388}.
The message enc((tag4,a[],scope_12,u[],password[]),k2_8) that the attacker may have by 9 may be received at input {394}.
So the message enc((tag5,code_12,i[]),k2_8) may be sent to the attacker at output {403}.
attacker(enc((tag5,code_12,i[]),k2_8)).

11. The attacker has some term e1_3.
attacker(e1_3).

12. The attacker has some term e2_3.
attacker(e2_3).

13. The attacker has some term pke1_6.
attacker(pke1_6).

14. The attacker has some term pke2_6.
attacker(pke2_6).

15. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 5 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 8 may be received at input {229}.
The message enc((tag5,code_12,i[]),k2_8) that the attacker may have by 10 may be received at input {236}.
So the message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) may be sent to the attacker at output {243}.
attacker(aenc((tag6,n_12,pk(sskI_9)),pk(ska[]))).

16. The message e1_3 that the attacker may have by 11 may be received at input {22}.
The message e2_3 that the attacker may have by 12 may be received at input {23}.
The message pke1_6 that the attacker may have by 13 may be received at input {162}.
The message pke2_6 that the attacker may have by 14 may be received at input {163}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 15 may be received at input {168}.
We have e2_3 Ôëá i[] && e1_3 Ôëá u[].
So the message aenc((tag7,n_12,k1_8),pk(sskI_9)) may be sent to the attacker at output {174}.
attacker(aenc((tag7,n_12,k1_8),pk(sskI_9))).

17. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 2 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 5 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 8 may be received at input {229}.
The message enc((tag5,code_12,i[]),k2_8) that the attacker may have by 10 may be received at input {236}.
The message aenc((tag7,n_12,k1_8),pk(sskI_9)) that the attacker may have by 16 may be received at input {244}.
So the message check_reach_browser[] may be sent to the attacker at output {252}.
attacker(check_reach_browser[]).

18. By 17, attacker(check_reach_browser[]).
The goal is reached, represented in the following fact:
attacker(check_reach_browser[]).


A more detailed output of the traces is available with
  set traceDisplay = long.

new a: bitstring creating a_4 at {1}

new u: bitstring creating u_4 at {2}

new i: bitstring creating i_4 at {3}

out(c, ~M) with ~M = a_4 at {4}

out(c, ~M_1) with ~M_1 = u_4 at {5}

out(c, ~M_2) with ~M_2 = i_4 at {6}

new ska: SecretKey creating ska_2 at {7}

new sku: SecretKey creating sku_2 at {8}

new ski: SecretKey creating ski_2 at {9}

out(c, ~M_3) with ~M_3 = pk(ska_2) at {10}

out(c, ~M_4) with ~M_4 = pk(sku_2) at {11}

out(c, ~M_5) with ~M_5 = pk(ski_2) at {12}

new password: bitstring creating password_7 at {13}

in(c, a_5) at {22} in copy a_6

in(c, a_7) at {23} in copy a_6

in(c, a_8) at {162} in copy a_6

in(c, a_9) at {163} in copy a_6

new scope_3: bitstring creating scope_12 at {165} in copy a_6

out(c, (~M_6,~M_7,~M_8)) with ~M_6 = tag1, ~M_7 = a_4, ~M_8 = scope_12 at {167} in copy a_6

in(c, ~M) with ~M = a_4 at {217} in copy a_10

in(c, ~M_2) with ~M_2 = i_4 at {218} in copy a_10

in(c, (tag1,~M,a_11)) with ~M = a_4 at {221} in copy a_10

new n2_4: bitstring creating n2_12 at {225} in copy a_10

new sskI: SecretKey creating sskI_8 at {226} in copy a_10

out(c, ~M_9) with ~M_9 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)) at {228} in copy a_10

in(c, ~M) with ~M = a_4 at {384} in copy a_12

in(c, ~M_1) with ~M_1 = u_4 at {385} in copy a_12

in(c, ~M_9) with ~M_9 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)) at {388} in copy a_12

new k2_4: SymmetricKey creating k2_8 at {391} in copy a_12

out(c, ~M_10) with ~M_10 = aenc((tag3,n2_12,k2_8),pk(sskI_8)) at {393} in copy a_12

in(c, ~M_10) with ~M_10 = aenc((tag3,n2_12,k2_8),pk(sskI_8)) at {229} in copy a_10

event browserSendsLastMessageToIssuer(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,a_11,u_4,password_7),k2_8)) at {234} in copy a_10

out(c, ~M_11) with ~M_11 = enc((tag4,a_4,a_11,u_4,password_7),k2_8) at {235} in copy a_10

in(c, ~M_11) with ~M_11 = enc((tag4,a_4,a_11,u_4,password_7),k2_8) at {394} in copy a_12

new code_8: bitstring creating code_12 at {400} in copy a_12

event issuerSendsLastMessageToBrowser(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,a_11,u_4,password_7),k2_8),enc((tag5,code_12,i_4),k2_8)) at {402} in copy a_12

out(c, ~M_12) with ~M_12 = enc((tag5,code_12,i_4),k2_8) at {403} in copy a_12

in(c, ~M_12) with ~M_12 = enc((tag5,code_12,i_4),k2_8) at {236} in copy a_10

new n_4: bitstring creating n_12 at {240} in copy a_10

new sskI_1: SecretKey creating sskI_9 at {241} in copy a_10

out(c, ~M_13) with ~M_13 = aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)) at {243} in copy a_10

in(c, ~M_13) with ~M_13 = aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)) at {168} in copy a_6

new k1_3: SymmetricKey creating k1_8 at {171} in copy a_6

event appSendsLastMessageToBrowser(aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9))) at {173} in copy a_6

out(c, ~M_14) with ~M_14 = aenc((tag7,n_12,k1_8),pk(sskI_9)) at {174} in copy a_6

in(c, ~M_14) with ~M_14 = aenc((tag7,n_12,k1_8),pk(sskI_9)) at {244} in copy a_10

event browserSendsLastMessageToApp(aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9)),enc((tag8,code_12,i_4),k1_8)) at {249} in copy a_10

out(c, ~M_15) with ~M_15 = enc((tag8,code_12,i_4),k1_8) at {250} in copy a_10

out(c, ~M_16) with ~M_16 = check_reach_browser at {252} in copy a_10

event browserCompletesProtocol(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,a_11,u_4,password_7),k2_8),enc((tag5,code_12,i_4),k2_8),aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9))) at {253} in copy a_10

The attacker has the message ~M_16 = check_reach_browser.
A trace has been found.
RESULT not attacker(check_reach_browser[]) is false.
-- Query not attacker(check_reach_issuer[]) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 46 rules.
400 rules inserted. Base: 320 rules (92 with conclusion selected). Queue: 89 rules.
600 rules inserted. Base: 441 rules (119 with conclusion selected). Queue: 78 rules.
800 rules inserted. Base: 530 rules (133 with conclusion selected). Queue: 83 rules.
1000 rules inserted. Base: 568 rules (146 with conclusion selected). Queue: 75 rules.
1200 rules inserted. Base: 628 rules (167 with conclusion selected). Queue: 56 rules.
1400 rules inserted. Base: 719 rules (197 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 778 rules (217 with conclusion selected). Queue: 77 rules.
1800 rules inserted. Base: 850 rules (246 with conclusion selected). Queue: 98 rules.
2000 rules inserted. Base: 947 rules (277 with conclusion selected). Queue: 78 rules.
2200 rules inserted. Base: 1065 rules (306 with conclusion selected). Queue: 57 rules.
2400 rules inserted. Base: 1169 rules (323 with conclusion selected). Queue: 23 rules.
Starting query not attacker(check_reach_issuer[])
goal reachable: attacker(check_reach_issuer[])

Derivation:
Abbreviations:
n2_12 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_8)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_8)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1_1[m_2 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
n2_13 = n2_1[m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
sskI2_4 = sskI2_1[m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
k3_8 = k3_4[m_68 = aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
sks_4 = sks_1[m_13 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)),m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
jti_8 = jti_1[m_13 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)),m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_9)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]

1. The message a[] may be sent to the attacker at output {4}.
attacker(a[]).

2. The message u[] may be sent to the attacker at output {5}.
attacker(u[]).

3. The message i[] may be sent to the attacker at output {6}.
attacker(i[]).

4. The attacker has some term scope_12.
attacker(scope_12).

5. Using the function tag1 the attacker may obtain tag1.
attacker(tag1).

6. By 5, the attacker may know tag1.
By 1, the attacker may know a[].
By 4, the attacker may know scope_12.
Using the function 3-tuple the attacker may obtain (tag1,a[],scope_12).
attacker((tag1,a[],scope_12)).

7. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 3 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 6 may be received at input {221}.
So the message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) may be sent to the attacker at output {228}.
attacker(aenc((tag2,n2_12,pk(sskI_8)),pk(ski[]))).

8. The message a[] that the attacker may have by 1 may be received at input {384}.
The message u[] that the attacker may have by 2 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 7 may be received at input {388}.
So the message aenc((tag3,n2_12,k2_8),pk(sskI_8)) may be sent to the attacker at output {393}.
attacker(aenc((tag3,n2_12,k2_8),pk(sskI_8))).

9. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 3 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 6 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 8 may be received at input {229}.
So the message enc((tag4,a[],scope_12,u[],password[]),k2_8) may be sent to the attacker at output {235}.
attacker(enc((tag4,a[],scope_12,u[],password[]),k2_8)).

10. The attacker has some term e1_3.
attacker(e1_3).

11. The attacker has some term pke1_6.
attacker(pke1_6).

12. The message a[] that the attacker may have by 1 may be received at input {384}.
The message u[] that the attacker may have by 2 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 7 may be received at input {388}.
The message enc((tag4,a[],scope_12,u[],password[]),k2_8) that the attacker may have by 9 may be received at input {394}.
So the message enc((tag5,code_12,i[]),k2_8) may be sent to the attacker at output {403}.
attacker(enc((tag5,code_12,i[]),k2_8)).

13. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 3 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 6 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 8 may be received at input {229}.
The message enc((tag5,code_12,i[]),k2_8) that the attacker may have by 12 may be received at input {236}.
So the message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) may be sent to the attacker at output {243}.
attacker(aenc((tag6,n_12,pk(sskI_9)),pk(ska[]))).

14. The message e1_3 that the attacker may have by 10 may be received at input {22}.
The message i[] that the attacker may have by 3 may be received at input {23}.
The message pke1_6 that the attacker may have by 11 may be received at input {70}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 13 may be received at input {75}.
We have e1_3 Ôëá u[].
So the message aenc((tag7,n_12,k1_8),pk(sskI_9)) may be sent to the attacker at output {81}.
attacker(aenc((tag7,n_12,k1_8),pk(sskI_9))).

15. The message a[] that the attacker may have by 1 may be received at input {217}.
The message i[] that the attacker may have by 3 may be received at input {218}.
The message (tag1,a[],scope_12) that the attacker may have by 6 may be received at input {221}.
The message aenc((tag3,n2_12,k2_8),pk(sskI_8)) that the attacker may have by 8 may be received at input {229}.
The message enc((tag5,code_12,i[]),k2_8) that the attacker may have by 12 may be received at input {236}.
The message aenc((tag7,n_12,k1_8),pk(sskI_9)) that the attacker may have by 14 may be received at input {244}.
So the message enc((tag8,code_12,i[]),k1_8) may be sent to the attacker at output {250}.
attacker(enc((tag8,code_12,i[]),k1_8)).

16. The message e1_3 that the attacker may have by 10 may be received at input {22}.
The message i[] that the attacker may have by 3 may be received at input {23}.
The message pke1_6 that the attacker may have by 11 may be received at input {70}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 13 may be received at input {75}.
The message enc((tag8,code_12,i[]),k1_8) that the attacker may have by 15 may be received at input {82}.
We have e1_3 Ôëá u[].
So the message aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])) may be sent to the attacker at output {89}.
attacker(aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[]))).

17. The message a[] that the attacker may have by 1 may be received at input {384}.
The message u[] that the attacker may have by 2 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 7 may be received at input {388}.
The message enc((tag4,a[],scope_12,u[],password[]),k2_8) that the attacker may have by 9 may be received at input {394}.
The message aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])) that the attacker may have by 16 may be received at input {404}.
So the message aenc((tag10,n2_13,k3_8),pk(sskI2_4)) may be sent to the attacker at output {409}.
attacker(aenc((tag10,n2_13,k3_8),pk(sskI2_4))).

18. The message e1_3 that the attacker may have by 10 may be received at input {22}.
The message i[] that the attacker may have by 3 may be received at input {23}.
The message pke1_6 that the attacker may have by 11 may be received at input {70}.
The message aenc((tag6,n_12,pk(sskI_9)),pk(ska[])) that the attacker may have by 13 may be received at input {75}.
The message enc((tag8,code_12,i[]),k1_8) that the attacker may have by 15 may be received at input {82}.
The message aenc((tag10,n2_13,k3_8),pk(sskI2_4)) that the attacker may have by 17 may be received at input {90}.
We have e1_3 Ôëá u[].
So the message enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8) may be sent to the attacker at output {99}.
attacker(enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8)).

19. The message a[] that the attacker may have by 1 may be received at input {384}.
The message u[] that the attacker may have by 2 may be received at input {385}.
The message aenc((tag2,n2_12,pk(sskI_8)),pk(ski[])) that the attacker may have by 7 may be received at input {388}.
The message enc((tag4,a[],scope_12,u[],password[]),k2_8) that the attacker may have by 9 may be received at input {394}.
The message aenc((tag9,n2_13,pk(sskI2_4)),pk(ski[])) that the attacker may have by 16 may be received at input {404}.
The message enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8) that the attacker may have by 18 may be received at input {410}.
So the message check_reach_issuer[] may be sent to the attacker at output {422}.
attacker(check_reach_issuer[]).

20. By 19, attacker(check_reach_issuer[]).
The goal is reached, represented in the following fact:
attacker(check_reach_issuer[]).


A more detailed output of the traces is available with
  set traceDisplay = long.

new a: bitstring creating a_4 at {1}

new u: bitstring creating u_4 at {2}

new i: bitstring creating i_4 at {3}

out(c, ~M) with ~M = a_4 at {4}

out(c, ~M_1) with ~M_1 = u_4 at {5}

out(c, ~M_2) with ~M_2 = i_4 at {6}

new ska: SecretKey creating ska_2 at {7}

new sku: SecretKey creating sku_2 at {8}

new ski: SecretKey creating ski_2 at {9}

out(c, ~M_3) with ~M_3 = pk(ska_2) at {10}

out(c, ~M_4) with ~M_4 = pk(sku_2) at {11}

out(c, ~M_5) with ~M_5 = pk(ski_2) at {12}

new password: bitstring creating password_7 at {13}

in(c, a_5) at {22} in copy a_6

in(c, ~M_2) with ~M_2 = i_4 at {23} in copy a_6

in(c, a_7) at {70} in copy a_6

new scope_1: bitstring creating scope_12 at {72} in copy a_6

out(c, (~M_6,~M_7,~M_8)) with ~M_6 = tag1, ~M_7 = a_4, ~M_8 = scope_12 at {74} in copy a_6

in(c, ~M) with ~M = a_4 at {217} in copy a_8

in(c, ~M_2) with ~M_2 = i_4 at {218} in copy a_8

in(c, (tag1,~M,a_9)) with ~M = a_4 at {221} in copy a_8

new n2_4: bitstring creating n2_12 at {225} in copy a_8

new sskI: SecretKey creating sskI_8 at {226} in copy a_8

out(c, ~M_9) with ~M_9 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)) at {228} in copy a_8

in(c, ~M) with ~M = a_4 at {384} in copy a_10

in(c, ~M_1) with ~M_1 = u_4 at {385} in copy a_10

in(c, ~M_9) with ~M_9 = aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)) at {388} in copy a_10

new k2_4: SymmetricKey creating k2_8 at {391} in copy a_10

out(c, ~M_10) with ~M_10 = aenc((tag3,n2_12,k2_8),pk(sskI_8)) at {393} in copy a_10

in(c, ~M_10) with ~M_10 = aenc((tag3,n2_12,k2_8),pk(sskI_8)) at {229} in copy a_8

event browserSendsLastMessageToIssuer(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,a_9,u_4,password_7),k2_8)) at {234} in copy a_8

out(c, ~M_11) with ~M_11 = enc((tag4,a_4,a_9,u_4,password_7),k2_8) at {235} in copy a_8

in(c, ~M_11) with ~M_11 = enc((tag4,a_4,a_9,u_4,password_7),k2_8) at {394} in copy a_10

new code_8: bitstring creating code_12 at {400} in copy a_10

event issuerSendsLastMessageToBrowser(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,a_9,u_4,password_7),k2_8),enc((tag5,code_12,i_4),k2_8)) at {402} in copy a_10

out(c, ~M_12) with ~M_12 = enc((tag5,code_12,i_4),k2_8) at {403} in copy a_10

in(c, ~M_12) with ~M_12 = enc((tag5,code_12,i_4),k2_8) at {236} in copy a_8

new n_4: bitstring creating n_12 at {240} in copy a_8

new sskI_1: SecretKey creating sskI_9 at {241} in copy a_8

out(c, ~M_13) with ~M_13 = aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)) at {243} in copy a_8

in(c, ~M_13) with ~M_13 = aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)) at {75} in copy a_6

new k1_1: SymmetricKey creating k1_8 at {78} in copy a_6

event appSendsLastMessageToBrowser(aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9))) at {80} in copy a_6

out(c, ~M_14) with ~M_14 = aenc((tag7,n_12,k1_8),pk(sskI_9)) at {81} in copy a_6

in(c, ~M_14) with ~M_14 = aenc((tag7,n_12,k1_8),pk(sskI_9)) at {244} in copy a_8

event browserSendsLastMessageToApp(aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9)),enc((tag8,code_12,i_4),k1_8)) at {249} in copy a_8

out(c, ~M_15) with ~M_15 = enc((tag8,code_12,i_4),k1_8) at {250} in copy a_8

out(c, ~M_16) with ~M_16 = check_reach_browser at {252} in copy a_8

event browserCompletesProtocol(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,a_9,u_4,password_7),k2_8),enc((tag5,code_12,i_4),k2_8),aenc((tag6,n_12,pk(sskI_9)),pk(ska_2)),aenc((tag7,n_12,k1_8),pk(sskI_9))) at {253} in copy a_8

in(c, ~M_15) with ~M_15 = enc((tag8,code_12,i_4),k1_8) at {82} in copy a_6

new n2_1: bitstring creating n2_13 at {86} in copy a_6

new sskI2_1: SecretKey creating sskI2_4 at {87} in copy a_6

out(c, ~M_17) with ~M_17 = aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)) at {89} in copy a_6

in(c, ~M_17) with ~M_17 = aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)) at {404} in copy a_10

new k3_4: SymmetricKey creating k3_8 at {407} in copy a_10

out(c, ~M_18) with ~M_18 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)) at {409} in copy a_10

in(c, ~M_18) with ~M_18 = aenc((tag10,n2_13,k3_8),pk(sskI2_4)) at {90} in copy a_6

new sks_1: SecretKey creating sks_4 at {94} in copy a_6

new jti_1: bitstring creating jti_8 at {95} in copy a_6

event appSendsLastMessageToIssuer(aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)),aenc((tag10,n2_13,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8)) at {98} in copy a_6

out(c, ~M_19) with ~M_19 = enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8) at {99} in copy a_6

in(c, ~M_19) with ~M_19 = enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8) at {410} in copy a_10

event issuerSendsLastMessageToApp(aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)),aenc((tag10,n2_13,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8),enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,a_9,a_4,i_4,u_4),ski_2)),k3_8)) at {419} in copy a_10

out(c, ~M_20) with ~M_20 = enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,a_9,a_4,i_4,u_4),ski_2)),k3_8) at {420} in copy a_10

out(c, ~M_21) with ~M_21 = check_reach_issuer at {422} in copy a_10

event issuerCompletesProtocol(aenc((tag2,n2_12,pk(sskI_8)),pk(ski_2)),aenc((tag3,n2_12,k2_8),pk(sskI_8)),enc((tag4,a_4,a_9,u_4,password_7),k2_8),aenc((tag9,n2_13,pk(sskI2_4)),pk(ski_2)),aenc((tag10,n2_13,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a_4,jti_8,code_12),sks_4)),k3_8)) at {423} in copy a_10

The attacker has the message ~M_21 = check_reach_issuer.
A trace has been found.
RESULT not attacker(check_reach_issuer[]) is false.
-- Query not attacker(free_code[]) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 46 rules.
400 rules inserted. Base: 320 rules (92 with conclusion selected). Queue: 89 rules.
600 rules inserted. Base: 441 rules (119 with conclusion selected). Queue: 78 rules.
800 rules inserted. Base: 530 rules (133 with conclusion selected). Queue: 83 rules.
1000 rules inserted. Base: 568 rules (146 with conclusion selected). Queue: 75 rules.
1200 rules inserted. Base: 628 rules (167 with conclusion selected). Queue: 56 rules.
1400 rules inserted. Base: 719 rules (197 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 778 rules (217 with conclusion selected). Queue: 77 rules.
1800 rules inserted. Base: 850 rules (246 with conclusion selected). Queue: 98 rules.
2000 rules inserted. Base: 947 rules (277 with conclusion selected). Queue: 78 rules.
2200 rules inserted. Base: 1065 rules (306 with conclusion selected). Queue: 57 rules.
2400 rules inserted. Base: 1169 rules (323 with conclusion selected). Queue: 23 rules.
Starting query not attacker(free_code[])
RESULT not attacker(free_code[]) is true.
-- Query not attacker(free_password[]) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 46 rules.
400 rules inserted. Base: 320 rules (92 with conclusion selected). Queue: 89 rules.
600 rules inserted. Base: 441 rules (119 with conclusion selected). Queue: 78 rules.
800 rules inserted. Base: 530 rules (133 with conclusion selected). Queue: 83 rules.
1000 rules inserted. Base: 568 rules (146 with conclusion selected). Queue: 75 rules.
1200 rules inserted. Base: 628 rules (167 with conclusion selected). Queue: 56 rules.
1400 rules inserted. Base: 719 rules (197 with conclusion selected). Queue: 102 rules.
1600 rules inserted. Base: 778 rules (217 with conclusion selected). Queue: 77 rules.
1800 rules inserted. Base: 850 rules (246 with conclusion selected). Queue: 98 rules.
2000 rules inserted. Base: 947 rules (277 with conclusion selected). Queue: 78 rules.
2200 rules inserted. Base: 1065 rules (306 with conclusion selected). Queue: 57 rules.
2400 rules inserted. Base: 1169 rules (323 with conclusion selected). Queue: 23 rules.
Starting query not attacker(free_password[])
RESULT not attacker(free_password[]) is true.
-- Query inj-event(appCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101,m_102)) ==> inj-event(browserSendsLastMessageToApp(m_96,m_97,m_98)) && inj-event(issuerSendsLastMessageToApp(m_99,m_100,m_101,m_102)) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 53 rules.
400 rules inserted. Base: 329 rules (88 with conclusion selected). Queue: 93 rules.
600 rules inserted. Base: 447 rules (116 with conclusion selected). Queue: 94 rules.
800 rules inserted. Base: 552 rules (132 with conclusion selected). Queue: 81 rules.
1000 rules inserted. Base: 571 rules (145 with conclusion selected). Queue: 100 rules.
1200 rules inserted. Base: 642 rules (160 with conclusion selected). Queue: 58 rules.
1400 rules inserted. Base: 742 rules (193 with conclusion selected). Queue: 104 rules.
1600 rules inserted. Base: 816 rules (213 with conclusion selected). Queue: 94 rules.
1800 rules inserted. Base: 877 rules (231 with conclusion selected). Queue: 107 rules.
2000 rules inserted. Base: 980 rules (258 with conclusion selected). Queue: 125 rules.
2200 rules inserted. Base: 1082 rules (284 with conclusion selected). Queue: 127 rules.
2400 rules inserted. Base: 1204 rules (305 with conclusion selected). Queue: 91 rules.
2600 rules inserted. Base: 1315 rules (316 with conclusion selected). Queue: 55 rules.
2800 rules inserted. Base: 1429 rules (334 with conclusion selected). Queue: 21 rules.
Starting query inj-event(appCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101,m_102)) ==> inj-event(browserSendsLastMessageToApp(m_96,m_97,m_98)) && inj-event(issuerSendsLastMessageToApp(m_99,m_100,m_101,m_102))
goal reachable: begin(issuerSendsLastMessageToApp(aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),aenc((tag10,n2_12,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8),enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a[],i[],u[]),ski[])),k3_8)),@occ419_1) && begin(browserSendsLastMessageToApp(aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8)),enc((tag8,code_12,i[]),k1_8)),@occ249_1) -> end(@occ67_1,appCompletesProtocol(aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8)),enc((tag8,code_12,i[]),k1_8),aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),aenc((tag10,n2_12,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8),enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a[],i[],u[]),ski[])),k3_8)))
The 1st, 2nd hypotheses occur strictly before the conclusion.
Abbreviations:
scope_12 = scope[e2 = i[],e1 = u[],!1 = @sid]
n2_13 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
sskI_9 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
k2_8 = k2_4[m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_2]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_2]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
sskI_8 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
k1_8 = k1[m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
n2_12 = n2[m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
sskI2_4 = sskI2[m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
k3_8 = k3_4[m_68 = aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_2]
sks_4 = sks[m_10 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
jti_8 = jti[m_10 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
@occ67_1 = @occ67[m_12 = enc((tag12,sign((hash_pk(pk(sks_4)),jti_8,scope_12,a[],i[],u[]),ski[])),k3_8),m_10 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid]
@occ419_1 = @occ419[m_70 = enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8),m_68 = aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_2]
@occ249_1 = @occ249[m_38 = aenc((tag7,n_12,k1_8),pk(sskI_8)),m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid_1]
RESULT inj-event(appCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101,m_102)) ==> inj-event(browserSendsLastMessageToApp(m_96,m_97,m_98)) && inj-event(issuerSendsLastMessageToApp(m_99,m_100,m_101,m_102)) is true.
-- Query inj-event(browserCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToBrowser(m_100,m_101)) && inj-event(issuerSendsLastMessageToBrowser(m_96,m_97,m_98,m_99)) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 50 rules.
400 rules inserted. Base: 324 rules (92 with conclusion selected). Queue: 92 rules.
600 rules inserted. Base: 445 rules (118 with conclusion selected). Queue: 85 rules.
800 rules inserted. Base: 544 rules (133 with conclusion selected). Queue: 84 rules.
1000 rules inserted. Base: 573 rules (146 with conclusion selected). Queue: 86 rules.
1200 rules inserted. Base: 643 rules (164 with conclusion selected). Queue: 54 rules.
1400 rules inserted. Base: 739 rules (195 with conclusion selected). Queue: 106 rules.
1600 rules inserted. Base: 816 rules (215 with conclusion selected). Queue: 103 rules.
1800 rules inserted. Base: 873 rules (231 with conclusion selected). Queue: 111 rules.
2000 rules inserted. Base: 975 rules (260 with conclusion selected). Queue: 128 rules.
2200 rules inserted. Base: 1081 rules (288 with conclusion selected). Queue: 128 rules.
2400 rules inserted. Base: 1199 rules (308 with conclusion selected). Queue: 94 rules.
2600 rules inserted. Base: 1312 rules (319 with conclusion selected). Queue: 64 rules.
2800 rules inserted. Base: 1427 rules (336 with conclusion selected). Queue: 23 rules.
Starting query inj-event(browserCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToBrowser(m_100,m_101)) && inj-event(issuerSendsLastMessageToBrowser(m_96,m_97,m_98,m_99))
goal reachable: e2_3 Ôëá i[] && e1_3 Ôëá u[] && begin(appSendsLastMessageToBrowser(aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))),@occ173_1) && attacker(pke2_6) && attacker(pke1_6) && attacker(e2_3) && attacker(e1_3) && begin(issuerSendsLastMessageToBrowser(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8)),@occ402_1) && attacker(scope_12) -> end(@occ253_1,browserCompletesProtocol(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8),aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))))
The 1st, 6th hypotheses occur strictly before the conclusion.
The 2nd, 3rd, 4th, 5th, 7th hypotheses occur before the conclusion.
Abbreviations:
n2_12 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1_3[m_25 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke2_1 = pke2_6,pke1_1 = pke1_6,e2 = e2_3,e1 = e1_3,!1 = @sid_2]
@occ253_1 = @occ253[m_38 = aenc((tag7,n_12,k1_8),pk(sskI_8)),m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
@occ173_1 = @occ173[m_25 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke2_1 = pke2_6,pke1_1 = pke1_6,e2 = e2_3,e1 = e1_3,!1 = @sid_2]
@occ402_1 = @occ402[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
goal reachable: e2_3 Ôëá i[] && begin(appSendsLastMessageToBrowser(aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))),@occ126_1) && attacker(pke2_6) && attacker(e2_3) && begin(issuerSendsLastMessageToBrowser(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8)),@occ402_1) && attacker(scope_12) -> end(@occ253_1,browserCompletesProtocol(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8),aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))))
The 1st, 4th hypotheses occur strictly before the conclusion.
The 2nd, 3rd, 5th hypotheses occur before the conclusion.
Abbreviations:
n2_12 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1_2[m_17 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke2 = pke2_6,e2 = e2_3,e1 = u[],!1 = @sid_2]
@occ253_1 = @occ253[m_38 = aenc((tag7,n_12,k1_8),pk(sskI_8)),m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
@occ126_1 = @occ126[m_17 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke2 = pke2_6,e2 = e2_3,e1 = u[],!1 = @sid_2]
@occ402_1 = @occ402[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
goal reachable: e1_3 Ôëá u[] && begin(appSendsLastMessageToBrowser(aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))),@occ80_1) && attacker(pke1_6) && attacker(e1_3) && begin(issuerSendsLastMessageToBrowser(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8)),@occ402_1) && attacker(scope_12) -> end(@occ253_1,browserCompletesProtocol(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8),aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))))
The 1st, 4th hypotheses occur strictly before the conclusion.
The 2nd, 3rd, 5th hypotheses occur before the conclusion.
Abbreviations:
n2_12 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1_1[m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
@occ253_1 = @occ253[m_38 = aenc((tag7,n_12,k1_8),pk(sskI_8)),m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
@occ80_1 = @occ80[m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
@occ402_1 = @occ402[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
goal reachable: begin(appSendsLastMessageToBrowser(aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))),@occ34_1) && begin(issuerSendsLastMessageToBrowser(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8)),@occ402_1) && attacker(scope_12) -> end(@occ253_1,browserCompletesProtocol(aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_12,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),enc((tag5,code_12,i[]),k2_8),aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),aenc((tag7,n_12,k1_8),pk(sskI_8))))
The 1st, 2nd hypotheses occur strictly before the conclusion.
The 3rd hypothesis occurs before the conclusion.
Abbreviations:
n2_12 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1[m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
@occ253_1 = @occ253[m_38 = aenc((tag7,n_12,k1_8),pk(sskI_8)),m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_12,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
@occ34_1 = @occ34[m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
@occ402_1 = @occ402[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_12,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
RESULT inj-event(browserCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToBrowser(m_100,m_101)) && inj-event(issuerSendsLastMessageToBrowser(m_96,m_97,m_98,m_99)) is true.
-- Query inj-event(issuerCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToIssuer(m_99,m_100,m_101)) && inj-event(browserSendsLastMessageToIssuer(m_96,m_97,m_98)) in process 1.
Translating the process into Horn clauses...
Completing...
select attacker(pk(sk))/-5000
200 rules inserted. Base: 171 rules (50 with conclusion selected). Queue: 51 rules.
400 rules inserted. Base: 328 rules (89 with conclusion selected). Queue: 95 rules.
600 rules inserted. Base: 445 rules (116 with conclusion selected). Queue: 99 rules.
800 rules inserted. Base: 546 rules (131 with conclusion selected). Queue: 97 rules.
1000 rules inserted. Base: 584 rules (144 with conclusion selected). Queue: 106 rules.
1200 rules inserted. Base: 653 rules (158 with conclusion selected). Queue: 68 rules.
1400 rules inserted. Base: 744 rules (187 with conclusion selected). Queue: 91 rules.
1600 rules inserted. Base: 823 rules (212 with conclusion selected). Queue: 107 rules.
1800 rules inserted. Base: 886 rules (227 with conclusion selected). Queue: 111 rules.
2000 rules inserted. Base: 986 rules (248 with conclusion selected). Queue: 130 rules.
2200 rules inserted. Base: 1085 rules (281 with conclusion selected). Queue: 140 rules.
2400 rules inserted. Base: 1208 rules (297 with conclusion selected). Queue: 99 rules.
2600 rules inserted. Base: 1325 rules (315 with conclusion selected). Queue: 79 rules.
2800 rules inserted. Base: 1430 rules (327 with conclusion selected). Queue: 26 rules.
Starting query inj-event(issuerCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToIssuer(m_99,m_100,m_101)) && inj-event(browserSendsLastMessageToIssuer(m_96,m_97,m_98))
goal reachable: e1_3 Ôëá u[] && begin(appSendsLastMessageToIssuer(aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),aenc((tag10,n2_12,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8)),@occ98_1) && begin(@p_act(@occ244_1,aenc((tag7,n_12,k1_8),pk(sskI_8)))) && begin(@p_act(@occ236_1,enc((tag5,code_12,i[]),k2_8))) && attacker(pke1_6) && attacker(e1_3) && begin(browserSendsLastMessageToIssuer(aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_13,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8)),@occ234_1) && attacker(scope_12) -> end(@occ423_1,issuerCompletesProtocol(aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_13,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),aenc((tag10,n2_12,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8)))
The 1st, 2nd, 3rd, 6th hypotheses occur strictly before the conclusion.
The 4th, 5th, 7th hypotheses occur before the conclusion.
Abbreviations:
n2_13 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1_1[m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
n2_12 = n2_1[m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
sskI2_4 = sskI2_1[m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
k3_8 = k3_4[m_68 = aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
sks_4 = sks_1[m_13 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
jti_8 = jti_1[m_13 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
@occ423_1 = @occ423[m_70 = enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8),m_68 = aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
@occ98_1 = @occ98[m_13 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_4 = enc((tag8,code_12,i[]),k1_8),m_2 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),pke1 = pke1_6,e2 = i[],e1 = e1_3,!1 = @sid_2]
@occ244_1 = @occ244[!1 = @sid]
@occ236_1 = @occ236[!1 = @sid]
@occ234_1 = @occ234[m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
goal reachable: begin(appSendsLastMessageToIssuer(aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),aenc((tag10,n2_12,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8)),@occ52_1) && begin(@p_act(@occ244_1,aenc((tag7,n_12,k1_8),pk(sskI_8)))) && begin(@p_act(@occ236_1,enc((tag5,code_12,i[]),k2_8))) && begin(browserSendsLastMessageToIssuer(aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_13,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8)),@occ234_1) && attacker(scope_12) -> end(@occ423_1,issuerCompletesProtocol(aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),aenc((tag3,n2_13,k2_8),pk(sskI_9)),enc((tag4,a[],scope_12,u[],password[]),k2_8),aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),aenc((tag10,n2_12,k3_8),pk(sskI2_4)),enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8)))
The 1st, 2nd, 3rd, 4th hypotheses occur strictly before the conclusion.
The 5th hypothesis occurs before the conclusion.
Abbreviations:
n2_13 = n2_4[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_9 = sskI[m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k2_8 = k2_4[m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
code_12 = code_8[m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
n_12 = n_4[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
sskI_8 = sskI_1[m_36 = enc((tag5,code_12,i[]),k2_8),m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
k1_8 = k1[m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
n2_12 = n2[m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
sskI2_4 = sskI2[m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
k3_8 = k3_4[m_68 = aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
sks_4 = sks[m_10 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
jti_8 = jti[m_10 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
@occ423_1 = @occ423[m_70 = enc((tag11,pk(sks_4),sign((a[],jti_8,code_12),sks_4)),k3_8),m_68 = aenc((tag9,n2_12,pk(sskI2_4)),pk(ski[])),m_66 = enc((tag4,a[],scope_12,u[],password[]),k2_8),m_64 = aenc((tag2,n2_13,pk(sskI_9)),pk(ski[])),e2_2 = u[],e1_2 = a[],!1 = @sid_1]
@occ52_1 = @occ52[m_10 = aenc((tag10,n2_12,k3_8),pk(sskI2_4)),m_8 = enc((tag8,code_12,i[]),k1_8),m_6 = aenc((tag6,n_12,pk(sskI_8)),pk(ska[])),e2 = i[],e1 = u[],!1 = @sid_2]
@occ244_1 = @occ244[!1 = @sid]
@occ236_1 = @occ236[!1 = @sid]
@occ234_1 = @occ234[m_34 = aenc((tag3,n2_13,k2_8),pk(sskI_9)),m_32 = (tag1,a[],scope_12),e2_1 = i[],e1_1 = a[],!1 = @sid]
RESULT inj-event(issuerCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToIssuer(m_99,m_100,m_101)) && inj-event(browserSendsLastMessageToIssuer(m_96,m_97,m_98)) is true.

--------------------------------------------------------------
Verification summary:

Query not attacker(check_reach_app[]) is false.

Query not attacker(check_reach_browser[]) is false.

Query not attacker(check_reach_issuer[]) is false.

Query not attacker(free_code[]) is true.

Query not attacker(free_password[]) is true.

Query inj-event(appCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101,m_102)) ==> inj-event(browserSendsLastMessageToApp(m_96,m_97,m_98)) && inj-event(issuerSendsLastMessageToApp(m_99,m_100,m_101,m_102)) is true.

Query inj-event(browserCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToBrowser(m_100,m_101)) && inj-event(issuerSendsLastMessageToBrowser(m_96,m_97,m_98,m_99)) is true.

Query inj-event(issuerCompletesProtocol(m_96,m_97,m_98,m_99,m_100,m_101)) ==> inj-event(appSendsLastMessageToIssuer(m_99,m_100,m_101)) && inj-event(browserSendsLastMessageToIssuer(m_96,m_97,m_98)) is true.

--------------------------------------------------------------

