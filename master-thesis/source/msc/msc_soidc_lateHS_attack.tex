%\makebox[\textwidth][c] {

\begin{msc}[environment distance = 3cm]{Solid Open ID Connect - CSRF Attack}

\declinst[instance width = 3cm]{app}{$sk_{A}$, pk($sk_E$)}{App}
\declinst[instance width = 3cm]{browser}{pk($sk_A$), pk($sk_I$), password}{Browser}
\dummyinst[instance width = 3cm]{eve}
\declinst[instance width = 3cm]{issuer}{$sk_I$, password}{Issuer}

\mess{\small{$appID,h(pkce),scope$}}{app}{browser}
\nextlevel[2]
\mess{\small{$\{n_2, pk(sskI_2)\}_{pk(ski)}$}}{browser}{issuer}
\nextlevel[2]
\mess{\small{$\{n_2, k_2\}_{pk(sskI_2)}$}}{issuer}{browser}
\nextlevel[2]
\mess{\small{$\{appID,h(pkce),scope,browserID,password\}_{k_2}$}}{browser}{issuer}
\nextlevel[2]
\mess{\small{$\{code\}_{k_2}$}}{issuer}{browser}
\nextlevel[1]
\mess{\small{$\{n, pk(sskI)\}_{pk(ska)}$}}{browser}{app}
\nextlevel[2]
\mess{\small{$\{n, k_1\}_{pk(sskI)}$}}{app}{browser}
\nextlevel[2]
\mess{\small{$\{code\}_{k_1}$}}{browser}{app}
\nextlevel[2]
\stop*{browser}
\nextlevel[1]
\startinst{eve}{$sk_{E}$}{Eve as Issuer}
\nextlevel[2]
\mess{\small{$\{n_3, pk(sskI2)\}_{pk(sk)}$}}{app}{eve}
\nextlevel[2]
\mess{\small{$\{n_3, k_3\}_{pk(sskI2)}$}}{eve}{app}
\nextlevel[2]
\mess{\small{$\{pk(sks), sign((appID, jti, code, pkce), sks)\}_{k_3}$}}{app}{eve}
\nextlevel[2]
%\mess*{}{eve}{issuer}
%\nextlevel[2]
%\mess{\small{$\{sign((jtk,jti,scope,appID,issuerID,browserID), skI)\}_{k_3}$}}{issuer}{eve}
%\nextlevel[1]

\end{msc}

%}